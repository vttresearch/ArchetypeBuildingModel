<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library · ArchetypeBuildingModel</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ArchetypeBuildingModel</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">ArchetypeBuildingModel.jl</a></li><li><a class="tocitem" href="../defining_archetype_buildings/">Defining archetype buildings</a></li><li><a class="tocitem" href="../model_workflow/">Overview of the workflow</a></li><li><a class="tocitem" href="../archetype_modelling/">Archetype building modelling</a></li><li><a class="tocitem" href="../archetypebuildingweather/">ArchetypeBuildingWeather.py</a></li><li><a class="tocitem" href="../archetype_definitions/">Input data reference</a></li><li class="is-active"><a class="tocitem" href>Library</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Public"><span>Public</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/master/documentation/src/library.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Library"><a class="docs-heading-anchor" href="#Library">Library</a><a id="Library-1"></a><a class="docs-heading-anchor-permalink" href="#Library" title="Permalink"></a></h1><p>Automatically generated documentation based on the docstrings in the codebase.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#ArchetypeBuildingModel.AbstractNode"><code>ArchetypeBuildingModel.AbstractNode</code></a></li><li><a href="#ArchetypeBuildingModel.AbstractNodeNetwork"><code>ArchetypeBuildingModel.AbstractNodeNetwork</code></a></li><li><a href="#ArchetypeBuildingModel.AbstractProcess"><code>ArchetypeBuildingModel.AbstractProcess</code></a></li><li><a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuildingModel.ArchetypeBuilding</code></a></li><li><a href="#ArchetypeBuildingModel.ArchetypeBuildingResults"><code>ArchetypeBuildingModel.ArchetypeBuildingResults</code></a></li><li><a href="#ArchetypeBuildingModel.BackboneInput"><code>ArchetypeBuildingModel.BackboneInput</code></a></li><li><a href="#ArchetypeBuildingModel.BuildingDataType"><code>ArchetypeBuildingModel.BuildingDataType</code></a></li><li><a href="#ArchetypeBuildingModel.BuildingNodeData"><code>ArchetypeBuildingModel.BuildingNodeData</code></a></li><li><a href="#ArchetypeBuildingModel.BuildingNodeNetwork"><code>ArchetypeBuildingModel.BuildingNodeNetwork</code></a></li><li><a href="#ArchetypeBuildingModel.BuildingProcessData"><code>ArchetypeBuildingModel.BuildingProcessData</code></a></li><li><a href="#ArchetypeBuildingModel.EnvelopeData"><code>ArchetypeBuildingModel.EnvelopeData</code></a></li><li><a href="#ArchetypeBuildingModel.LoadsData"><code>ArchetypeBuildingModel.LoadsData</code></a></li><li><a href="#ArchetypeBuildingModel.ScopeData"><code>ArchetypeBuildingModel.ScopeData</code></a></li><li><a href="#ArchetypeBuildingModel.SpineOptInput"><code>ArchetypeBuildingModel.SpineOptInput</code></a></li><li><a href="#ArchetypeBuildingModel.StructureData"><code>ArchetypeBuildingModel.StructureData</code></a></li><li><a href="#ArchetypeBuildingModel.WeatherData"><code>ArchetypeBuildingModel.WeatherData</code></a></li><li><a href="#ArchetypeBuildingModel._building_period_weight"><code>ArchetypeBuildingModel._building_period_weight</code></a></li><li><a href="#ArchetypeBuildingModel._pyseries_to_timeseries"><code>ArchetypeBuildingModel._pyseries_to_timeseries</code></a></li><li><a href="#ArchetypeBuildingModel.add_archetype_to_input!"><code>ArchetypeBuildingModel.add_archetype_to_input!</code></a></li><li><a href="#ArchetypeBuildingModel.add_results!"><code>ArchetypeBuildingModel.add_results!</code></a></li><li><a href="#ArchetypeBuildingModel.aggregate_gfa_weights"><code>ArchetypeBuildingModel.aggregate_gfa_weights</code></a></li><li><a href="#ArchetypeBuildingModel.archetype_building_processing"><code>ArchetypeBuildingModel.archetype_building_processing</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>ArchetypeBuildingModel.calculate_base_floor_dimensions</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_convective_internal_heat_gains"><code>ArchetypeBuildingModel.calculate_convective_internal_heat_gains</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_convective_solar_gains"><code>ArchetypeBuildingModel.calculate_convective_solar_gains</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_cop"><code>ArchetypeBuildingModel.calculate_cop</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_effective_ground_temperature"><code>ArchetypeBuildingModel.calculate_effective_ground_temperature</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_exterior_wall_dimensions"><code>ArchetypeBuildingModel.calculate_exterior_wall_dimensions</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_gross_floor_area_weights"><code>ArchetypeBuildingModel.calculate_gross_floor_area_weights</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_interior_air_and_furniture_thermal_mass"><code>ArchetypeBuildingModel.calculate_interior_air_and_furniture_thermal_mass</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_partition_wall_dimensions"><code>ArchetypeBuildingModel.calculate_partition_wall_dimensions</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_radiative_internal_heat_gains"><code>ArchetypeBuildingModel.calculate_radiative_internal_heat_gains</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_radiative_solar_gains"><code>ArchetypeBuildingModel.calculate_radiative_solar_gains</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_roof_dimensions"><code>ArchetypeBuildingModel.calculate_roof_dimensions</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_separating_floor_dimensions"><code>ArchetypeBuildingModel.calculate_separating_floor_dimensions</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_structural_exterior_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_structural_exterior_heat_transfer_coefficient</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_structural_ground_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_structural_ground_heat_transfer_coefficient</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_structural_interior_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_structural_interior_heat_transfer_coefficient</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_structural_thermal_mass"><code>ArchetypeBuildingModel.calculate_structural_thermal_mass</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_total_dhw_demand"><code>ArchetypeBuildingModel.calculate_total_dhw_demand</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_total_internal_heat_loads"><code>ArchetypeBuildingModel.calculate_total_internal_heat_loads</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_total_solar_gains"><code>ArchetypeBuildingModel.calculate_total_solar_gains</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_total_thermal_bridge_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_total_thermal_bridge_heat_transfer_coefficient</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_ventilation_and_infiltration_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_ventilation_and_infiltration_heat_transfer_coefficient</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_vertical_envelope_surface_area"><code>ArchetypeBuildingModel.calculate_vertical_envelope_surface_area</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_window_dimensions"><code>ArchetypeBuildingModel.calculate_window_dimensions</code></a></li><li><a href="#ArchetypeBuildingModel.calculate_window_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_window_heat_transfer_coefficient</code></a></li><li><a href="#ArchetypeBuildingModel.create_abstract_node_network"><code>ArchetypeBuildingModel.create_abstract_node_network</code></a></li><li><a href="#ArchetypeBuildingModel.create_building_node_network"><code>ArchetypeBuildingModel.create_building_node_network</code></a></li><li><a href="#ArchetypeBuildingModel.create_building_weather"><code>ArchetypeBuildingModel.create_building_weather</code></a></li><li><a href="#ArchetypeBuildingModel.determine_temporal_structure"><code>ArchetypeBuildingModel.determine_temporal_structure</code></a></li><li><a href="#ArchetypeBuildingModel.form_and_invert_dynamics_matrix"><code>ArchetypeBuildingModel.form_and_invert_dynamics_matrix</code></a></li><li><a href="#ArchetypeBuildingModel.form_and_invert_hvac_matrix"><code>ArchetypeBuildingModel.form_and_invert_hvac_matrix</code></a></li><li><a href="#ArchetypeBuildingModel.initialize_result_relationship_classes!"><code>ArchetypeBuildingModel.initialize_result_relationship_classes!</code></a></li><li><a href="#ArchetypeBuildingModel.initialize_rhs"><code>ArchetypeBuildingModel.initialize_rhs</code></a></li><li><a href="#ArchetypeBuildingModel.initialize_temperatures"><code>ArchetypeBuildingModel.initialize_temperatures</code></a></li><li><a href="#ArchetypeBuildingModel.process_abstract_node"><code>ArchetypeBuildingModel.process_abstract_node</code></a></li><li><a href="#ArchetypeBuildingModel.process_abstract_system"><code>ArchetypeBuildingModel.process_abstract_system</code></a></li><li><a href="#ArchetypeBuildingModel.process_building_envelope"><code>ArchetypeBuildingModel.process_building_envelope</code></a></li><li><a href="#ArchetypeBuildingModel.process_building_loads"><code>ArchetypeBuildingModel.process_building_loads</code></a></li><li><a href="#ArchetypeBuildingModel.process_building_node"><code>ArchetypeBuildingModel.process_building_node</code></a></li><li><a href="#ArchetypeBuildingModel.process_building_stock_scope"><code>ArchetypeBuildingModel.process_building_stock_scope</code></a></li><li><a href="#ArchetypeBuildingModel.process_building_system"><code>ArchetypeBuildingModel.process_building_system</code></a></li><li><a href="#ArchetypeBuildingModel.process_structure_scope"><code>ArchetypeBuildingModel.process_structure_scope</code></a></li><li><a href="#ArchetypeBuildingModel.process_ventilation_and_fenestration_scope"><code>ArchetypeBuildingModel.process_ventilation_and_fenestration_scope</code></a></li><li><a href="#ArchetypeBuildingModel.process_weather"><code>ArchetypeBuildingModel.process_weather</code></a></li><li><a href="#ArchetypeBuildingModel.run_input_data_tests"><code>ArchetypeBuildingModel.run_input_data_tests</code></a></li><li><a href="#ArchetypeBuildingModel.run_object_class_tests"><code>ArchetypeBuildingModel.run_object_class_tests</code></a></li><li><a href="#ArchetypeBuildingModel.run_parameter_tests"><code>ArchetypeBuildingModel.run_parameter_tests</code></a></li><li><a href="#ArchetypeBuildingModel.run_structure_type_tests"><code>ArchetypeBuildingModel.run_structure_type_tests</code></a></li><li><a href="#ArchetypeBuildingModel.solve_archetype_building_hvac_demand"><code>ArchetypeBuildingModel.solve_archetype_building_hvac_demand</code></a></li><li><a href="#ArchetypeBuildingModel.solve_consumption"><code>ArchetypeBuildingModel.solve_consumption</code></a></li><li><a href="#ArchetypeBuildingModel.solve_heating_demand"><code>ArchetypeBuildingModel.solve_heating_demand</code></a></li><li><a href="#ArchetypeBuildingModel.solve_heating_demand_loop"><code>ArchetypeBuildingModel.solve_heating_demand_loop</code></a></li><li><a href="#ArchetypeBuildingModel.timeseries_to_backbone_map"><code>ArchetypeBuildingModel.timeseries_to_backbone_map</code></a></li><li><a href="#ArchetypeBuildingModel.write_to_url"><code>ArchetypeBuildingModel.write_to_url</code></a></li></ul><h2 id="Public"><a class="docs-heading-anchor" href="#Public">Public</a><a id="Public-1"></a><a class="docs-heading-anchor-permalink" href="#Public" title="Permalink"></a></h2><p>This section lists all types and functions exported by the module.</p><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.ArchetypeBuilding" href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuildingModel.ArchetypeBuilding</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ArchetypeBuilding(archetype::Object; mod::Module = @__MODULE__)</code></pre><p>Contains data representing a single archetype building.</p><p>The <code>ArchetypeBuilding</code> struct stores the information about the objects used in its construction, the aggregated statistical and structural properties, as well as the <a href="#ArchetypeBuildingModel.BuildingNodeData"><code>BuildingNodeData</code></a> and <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a>. Furthermore, the relevant <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> and <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a> used to create the large-scale energy system model input are also stored for convenience. The contents of the <code>ArchetypeBuilding</code> are intended to be as human-readable as possible to allow for inspecting the contents individually for debugging purposes.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from by the constructor, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>archetype::Object</code>: The <code>building_archetype</code> object corresponding to this <code>ArchetypeBuilding</code>.</li><li><code>scope::Object</code>: The defined <code>building_scope</code> for this archetype.</li><li><code>fabrics::Object</code>: The defined <code>building_fabrics</code> for this archetype.</li><li><code>systems::Object</code>: The defined <code>building_systems</code> for this archetype.</li><li><code>loads::Object</code>: The defined <code>building_loads</code> for this archetype.</li><li><code>weather::Object</code>: The defined <code>building_weather</code> for this archetype.</li><li><code>scope_data::ScopeData</code>: The processed <code>building_scope</code> data for this archetype.</li><li><code>envelope_data::EnvelopeData</code>: The processed envelope properties of this archetype.</li><li><code>building_nodes::BuildingNodeNetwork</code>: The temperature node network depicting this archetype.</li><li><code>building_processes::Dict{Object,BuildingProcessData}</code>: The processes in this archetype.</li><li><code>loads_data::LoadsData</code>: The loads defined for this archetype.</li><li><code>weather_data::WeatherData</code>: The processed weather data for this archetype.</li><li><code>abstract_nodes::AbstractNodeNetwork</code>: The processed <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>s depicting this archetype.</li><li><code>abstract_processes::Dict{Object,AbstractProcess}</code>: The processed <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>es in this archetype.</li></ul><p>The constructor performs the following steps:</p><ol><li>Fetch and create the corresponding <a href="#ArchetypeBuildingModel.WeatherData"><code>WeatherData</code></a>.</li><li>Fetch and create the corresponding <a href="#ArchetypeBuildingModel.ScopeData"><code>ScopeData</code></a>.</li><li>Form the <a href="#ArchetypeBuildingModel.EnvelopeData"><code>EnvelopeData</code></a>.</li><li>Process the <a href="#ArchetypeBuildingModel.LoadsData"><code>LoadsData</code></a>.</li><li>Process the temperature nodes using the <a href="#ArchetypeBuildingModel.create_building_node_network"><code>create_building_node_network</code></a> function.</li><li>Create the <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a> for the HVAC system components.</li><li>Process the abstract temperature nodes using the <a href="#ArchetypeBuildingModel.create_abstract_node_network"><code>create_abstract_node_network</code></a> function based on the <a href="#ArchetypeBuildingModel.BuildingNodeNetwork"><code>BuildingNodeNetwork</code></a>.</li><li>Create the <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>es corresponding to the <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a>s.</li><li>Construct the final <code>ArchetypeBuilding</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L642-L685">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.ArchetypeBuildingResults" href="#ArchetypeBuildingModel.ArchetypeBuildingResults"><code>ArchetypeBuildingModel.ArchetypeBuildingResults</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ArchetypeBuildingResults(
    archetype::ArchetypeBuilding;
    free_dynamics::Bool = false,
    initial_temperatures::Union{Nothing,Dict{Object,Float64}} = nothing,
    mod::Module = @__MODULE__,
) &lt;: BuildingDataType</code></pre><p>Store the temperature and HVAC demand results for the <code>archetype</code> building.</p><p>The <code>free_dynamics</code> keyword can be used to force the calculations to ignore heating/cooling set points, while the <code>initial_temperatures</code> keyword can be used to fix the initial temperatures for the simulation.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from by the constructor, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>archetype::ArchetypeBuilding</code>: The <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> for which the results were calculated.</li><li><code>free_dynamics::Bool</code>: Flag whether or not to ignore set point temperatures for free temperature dynamics.</li><li><code>initial_temperatures::Dict{Object,Float64}</code>: The initial temperatures used for the results.</li><li><code>temperatures::Dict{Object,SpineDataType}</code>: The resulting node temperatures in [K].</li><li><code>hvac_demand::Dict{Object,SpineDataType}</code>: The HVAC demand required to keep the temperature nodes within the permitted limits for each node.</li><li><code>hvac_consumption::Dict{Object,SpineDataType}</code>: The estimated energy consumption of the HVAC equipment required to fulfill the HVAC demand.</li></ul><p>The constructor performs the following steps:</p><ol><li>Solve the initial temperatures, node temperatures, and HVAC demand using the <a href="#ArchetypeBuildingModel.solve_heating_demand"><code>solve_heating_demand</code></a> function.</li><li>Solve the HVAC consumption using the <a href="#ArchetypeBuildingModel.solve_consumption"><code>solve_consumption</code></a> function.</li><li>Return the <code>ArchetypeBuildingResults</code> using the calculated values.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L800-L829">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.BackboneInput" href="#ArchetypeBuildingModel.BackboneInput"><code>ArchetypeBuildingModel.BackboneInput</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BackboneInput</code></pre><p>Create and store the input data for the Backbone energy system model.</p><p>Contains the following fields:</p><ul><li><code>boundary::ObjectClass</code>: Contains the <code>upwardLimit</code> and <code>downwardLimit</code> settings.</li><li><code>effLevel::ObjectClass</code>: All possible efficiency representation levels in Backbone.</li><li><code>effSelector::ObjectClass</code>: Contains the <code>directOff</code> efficiency representation used by the building model.</li><li><code>grid::ObjectClass</code>: Contains the <code>building</code> <code>grid</code> for building <code>node</code>s.</li><li><code>io::ObjectClass</code>: Contains the <code>input</code> and <code>output</code> indicators for <code>unit</code>s.</li><li><code>node::ObjectClass</code>: Contains all the <code>node</code>s in the building models, created based on <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>s.</li><li><code>unit::ObjectClass</code>: Contains all the <code>unit</code>s in the building models, created based on <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>es.</li><li><code>unittype::ObjectClass</code>: Contains a <code>HVAC</code> type for all building <code>unit</code>s.</li><li><code>effLevel__effSelector__unit::RelationshipClass</code>: Attributes the <code>directOff</code> efficiency representation for all <code>unit</code>s for all efficiency representation levels.</li><li><code>grid__node::RelationshipClass</code>: Connects all <code>node</code>s into the <code>building</code> <code>grid</code>.</li><li><code>grid__node__boundary::RelationshipClass</code>: Contains the <code>upwardLimit</code> and <code>downwardLimit</code> parameters for all <code>node</code>s.</li><li><code>grid__node__node::RelationshipClass</code>: Contains the <code>diffCoeff</code> diffusion parameters between the <code>node</code>s.</li><li><code>grid__node__unit__io::RelationshipClass</code>: Defines how the <code>unit</code>s interact with the <code>node</code>s, and contains the necessary parameters.</li><li><code>unit__unittype::RelationshipClass</code>: Indicates all <code>unit</code>s as of type <code>HVAC</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/create_backbone_input.jl#L7-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.BuildingProcessData" href="#ArchetypeBuildingModel.BuildingProcessData"><code>ArchetypeBuildingModel.BuildingProcessData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BuildingProcessData(
    archetype::Object,
    process::Object,
    scope::ScopeData,
    weather::WeatherData;
    mod::Module = @__MODULE__,
) &lt;: BuildingDataType</code></pre><p>Aggregate building systems into processes for the lumped-capacitance thermal model.</p><p>The <code>BuildingProcessData</code> struct aims to remain as human-readable as possible, making it a high-level description of the properties of a process in the lumped-capacitance thermal model. Ultimately, <code>BuildingProcessData</code>s are converted into <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>s for exporting into energy-system-model-specific input data formats.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>building_process::Object</code>: The <code>building_process</code> definition for this <code>BuildingProcessData</code>.</li><li><code>system_link_nodes::Vector{Object}</code>: The energy system nodes used to connect the buildings to the energy system at large.</li><li><code>coefficient_of_performance::SpineDataType</code>: The coefficient of performance of the process.</li><li><code>coefficient_of_performance_mode::Symbol</code>: The mode of the process, either <code>:heating</code> or <code>:cooling</code>.</li><li><code>maximum_power_base_W::Dict{Tuple{Object,Object},SpineDataType}</code>: User-defined base maximum power flows in [W] between this process and the nodes.</li><li><code>maximum_power_gfa_scaled_W::Dict{Tuple{Object,Object},SpineDataType}</code>: User-defined gross-floor-area-scaling maximum power flows in [W] between this process and the nodes.</li><li><code>number_of_processes::Float64</code>: The number of aggregated processes this one depicts for the large-scale energy system models.</li></ul><p>The constructor calls the <a href="#ArchetypeBuildingModel.process_building_system"><code>process_building_system</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L475-L505">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.EnvelopeData" href="#ArchetypeBuildingModel.EnvelopeData"><code>ArchetypeBuildingModel.EnvelopeData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EnvelopeData(archetype::Object, data::ScopeData; mod::Module = @__MODULE__) &lt;: BuildingDataType</code></pre><p>Store the calculated dimensions of the different parts of the building envelope.</p><p><code>EnvelopeData</code> is generated based on the <code>building_archetype</code> parameters and the aggregated <a href="#ArchetypeBuildingModel.ScopeData"><code>ScopeData</code></a>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from by the constructor, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>base_floor::NamedTuple</code>: Linear thermal bridge length [m] and surface area [m2] of the base floor.</li><li><code>exterior_wall::NamedTuple</code>: Linear thermal bridge length [m] and surface area [m2] of the load-bearing exterior walls.</li><li><code>light_exterior_wall::NamedTuple</code>: Linear thermal bridge length [m] and surface area [m2] of the light exterior walls.</li><li><code>light_partition_wall::NamedTuple</code>: Linear thermal bridge length [m] and one-sided surface area [m2] of the light partition walls.</li><li><code>partition_wall::NamedTuple</code>: Linear thermal bridge length [m] and one-sided surface area [m2] of the load-bearing partition walls.</li><li><code>roof::NamedTuple</code>: Linear thermal bridge length [m] and surface area [m2] of the roof.</li><li><code>separating_floor::NamedTuple</code>: Linear thermal bridge length [m] and one-sided surface area [m2] of the partition floors.</li><li><code>window::NamedTuple</code>: Linear thermal bridge length [m] and surface area [m2] of the windows.</li></ul><p>The constructor calls the <a href="#ArchetypeBuildingModel.process_building_envelope"><code>process_building_envelope</code></a> function and checks that the results are sensible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L219-L242">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.LoadsData" href="#ArchetypeBuildingModel.LoadsData"><code>ArchetypeBuildingModel.LoadsData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LoadsData(
    archetype::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    weather::WeatherData;
    mod::Module = @__MODULE__,
) &lt;: BuildingDataType</code></pre><p>Store the domestic hot water demand and internal/solar heat gains data.</p><p>The domestic hot water demand and internal gains are calculated based on the provided base and GFA-scaling parameters, while the solar gains are calculated based on the <code>building_weather</code> object.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from by the constructor, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>domestic_hot_water_demand_W::SpineDataType</code>: Domestic hot water demand data in [W] for the building.</li><li><code>internal_heat_gains_W::SpineDataType</code>: Total internal heat gains data in [W] for the building.</li><li><code>solar_heat_gains_W::SpineDataType</code>: Total solar heat gain data in [W] for the building.</li></ul><p>The constructor calls the <a href="#ArchetypeBuildingModel.process_building_loads"><code>process_building_loads</code></a> function and checks that the results are sensible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L294-L319">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.ScopeData" href="#ArchetypeBuildingModel.ScopeData"><code>ArchetypeBuildingModel.ScopeData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ScopeData(scope::Object; mod::Module = @__MODULE__) &lt;: BuildingDataType</code></pre><p>Aggregate and store data defined by a <code>building_scope</code> object.</p><p>Essentially, stores information about the aggregated properties of the desired portion of the building stock, as defined by the <code>building_scope</code> object in the archetype building definition database.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from by the constructor, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>building_scope::Object</code>: The <code>building_scope</code> used to define this <code>ScopeData</code>.</li><li><code>number_of_buildings::Float64</code>: Number of buildings included in this <code>scope</code>.</li><li><code>average_gross_floor_area_m2_per_building::Float64</code>: Average GFA per building in [m2] of the buildings included in this <code>scope</code>.</li><li><code>HRU_efficiency::Float64</code>: Average ventilation heat-recovery unit efficiency of the buildings included in this <code>scope</code>.</li><li><code>infiltration_rate_1_h::Float64</code>: Average infiltration rate in [1/h] of teh buildings included in this <code>scope</code>.</li><li><code>total_normal_solar_energy_transmittance::Float64</code>: Average total normal solar energy transmittance of the windows included in this <code>scope</code>.</li><li><code>ventilation_rate_1_h::Float64</code>: Average ventilation rate in [1/h] of the buildings included in this <code>scope</code>.</li><li><code>window_U_value_W_m2K::Float64</code>: Average window U-value in [W/m2K] of the buildings included in this <code>scope</code>.</li><li><code>structure_data::Dict{Object,StructureData}</code>: <a href="#ArchetypeBuildingModel.StructureData"><code>StructureData</code></a> dictionary for the average structural parameters of the buildings included in this <code>scope</code>.</li><li><code>location_id_gfa_weights::Dict{Object,Float64}</code>: Gross-floor area weights for the <code>location_id</code>s included in this <code>scope</code>, used for automatic weather data processing.</li><li><code>shapefile_path::String</code>: Path to a shapefile describing the geography of this <code>scope</code>, used for the automatic weather data aggregation.</li><li><code>raster_weight_path::Union{String,Nothing}</code>: Optional path to a raster weight map for tweaking the automatic weather data aggregation.</li></ul><p>The constructor essentially performs the following steps:</p><ol><li>Process building stock statistics using the <a href="#ArchetypeBuildingModel.process_building_stock_scope"><code>process_building_stock_scope</code></a> function.</li><li>Process ventilation and fenestration statistics using the <a href="#ArchetypeBuildingModel.process_ventilation_and_fenestration_scope"><code>process_ventilation_and_fenestration_scope</code></a> function.</li><li>Process structure statistics using the <a href="#ArchetypeBuildingModel.process_structure_scope"><code>process_structure_scope</code></a> function.</li><li>Check that the values make sense.</li><li>Create the <code>ScopeData</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L56-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.SpineOptInput" href="#ArchetypeBuildingModel.SpineOptInput"><code>ArchetypeBuildingModel.SpineOptInput</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpineOptInput</code></pre><p>Create and store the input data for the SpineOpt energy system model.</p><p>Contains the following fields:</p><ul><li><code>node::ObjectClass</code>: Contains all the <code>node</code>s in the building models, created based on <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>s.</li><li><code>unit::ObjectClass</code>: Contains all the <code>unit</code>s in the building models, created based on <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>es.</li><li><code>node__node::RelationshipClass</code>: Defines the heat transfer coefficients between the <code>node</code>s.</li><li><code>unit__from_node::RelationshipClass</code>: Defines <code>unit</code> input flow properties.</li><li><code>unit__to_node::RelationshipClass</code>: Defines <code>unit</code> output flow properties.</li><li><code>unit__node__node::RelationshipClass</code>: Defines <code>unit</code> conversion properties.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/create_spineopt_input.jl#L7-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.WeatherData" href="#ArchetypeBuildingModel.WeatherData"><code>ArchetypeBuildingModel.WeatherData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WeatherData(weather::Object; mod::Module = @__MODULE__) &lt;: BuildingDataType</code></pre><p>Process and store the weather data for further calculations.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from by the constructor, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>building_weather::Object</code>: The <code>building_weather</code> object used to construct this <code>WeatherData</code>.</li><li><code>ambient_temperature_K::SpineDataType</code>: Ambient temperature data in [K].</li><li><code>ground_temperature_K::SpineDataType</code>: Effective ground temperature data in [K].</li><li><code>diffuse_solar_irradiation_W_m2::SpineDataType</code>: Diffuse solar irradiation data in [W/m2].</li><li><code>direct_solar_irradiation_W_m2::Dict{Symbol,SpineDataType}</code>: Direct solar irradiation data dictionary, containing irradiation for walls facing in different cardinal directions in [W/m2].</li></ul><p>Essentially, the constructor calls the <a href="#ArchetypeBuildingModel.process_weather"><code>process_weather</code></a> function, and checks that the resulting values are sensible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L175-L192">source</a></section></article><h3 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.add_results!" href="#ArchetypeBuildingModel.add_results!"><code>ArchetypeBuildingModel.add_results!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">add_results!(
    results__building_archetype__building_node::RelationshipClass,
    results__building_archetype__building_process::RelationshipClass,
    results_dictionary::Dict{Object,ArchetypeBuildingResults},
)

Add results from `results_dictionary` into the result `RelationshipClass`es.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/main.jl#L226-L234">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.archetype_building_processing" href="#ArchetypeBuildingModel.archetype_building_processing"><code>ArchetypeBuildingModel.archetype_building_processing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">archetype_building_processing(
    url_in::String,
    import_weather::Bool,
    save_layouts::Bool;
    weather_data_dictionary::Union{Nothing,Dict{Object,WeatherData}} = nothing,
    mod::Module = @__MODULE__,
)</code></pre><p>Process the <a href="#ArchetypeBuildingModel.ScopeData"><code>ScopeData</code></a>, <a href="#ArchetypeBuildingModel.WeatherData"><code>WeatherData</code></a>, and <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> objects.</p><p>Essentially, processes all the necessary information for <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> creation, and returns the <code>scope_data_dictionary</code>, <code>weather_data_dictionary</code>, and <code>archetype_dictionary</code> for examining the processed data. If <code>import_weather == true</code>, the automatically generated <a href="../archetype_definitions/#building_weather">building_weather</a> objects will be imported back into the database at <code>url_in</code>. If <code>save_layouts == true</code>, diagnostic figures of the layouts are saved into <code>figs/</code>. The <code>weather_data_dictionary</code> keyword can be used to bypass weather data processing if a pre-existing dictionary is provided. The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>This function performs the following steps:</p><ol><li>Construct the <a href="#ArchetypeBuildingModel.ScopeData"><code>ScopeData</code></a> for each defined <a href="../archetype_definitions/#building_archetype__building_scope">building_archetype__building_scope</a>, and store in the <code>scope_data_dictionary</code>.</li><li>Try to construct the <a href="#ArchetypeBuildingModel.WeatherData"><code>WeatherData</code></a> for each defined <a href="../archetype_definitions/#building_archetype__building_weather">building_archetype__building_weather</a>, and attempt automatic weather processing using <a href="../archetypebuildingweather/#ArchetypeBuildingWeather.py">ArchetypeBuildingWeather.py</a> if no definition found. Results stored in <code>weather_data_dictionary</code>.</li><li>Use the <code>scope_data_dictionary</code> and <code>weather_data_dictionary</code> to construct the <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> for all defined archetypes, and store them in <code>archetype_dictionary</code>.</li><li>Return <code>scope_data_dictionary</code>, <code>weather_data_dictionary</code>, and <code>archetype_dictionary</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/main.jl#L26-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.create_abstract_node_network" href="#ArchetypeBuildingModel.create_abstract_node_network"><code>ArchetypeBuildingModel.create_abstract_node_network</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_abstract_node_network(
    building_node_network::BuildingNodeNetwork,
    weather::WeatherData
)</code></pre><p>Process a <code>BuildingNodeNetwork</code> into an <code>AbstractNodeNetwork</code>.</p><p>The <code>AbstractNodeNetwork</code> is a useful step for creating model-agnostic input for multiple large-scale energy system models. <code>weather</code> is required to account for ambient temperatures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L825-L836">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.create_building_node_network" href="#ArchetypeBuildingModel.create_building_node_network"><code>ArchetypeBuildingModel.create_building_node_network</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_building_node_network(
    archetype::Object,
    fabrics::Object,
    systems::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    loads::LoadsData;
    mod::Module = @__MODULE__,
)</code></pre><p>Map all <code>archetype</code> <code>building_nodes</code> to their <a href="#ArchetypeBuildingModel.BuildingNodeData"><code>BuildingNodeData</code></a>s.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, loops over the <code>building_fabrics__building_node</code> and <code>building_systems__building_node</code> relationships for the desired <code>archetype</code>, and collects all the <code>building_node</code>s and <a href="#ArchetypeBuildingModel.BuildingNodeData"><code>BuildingNodeData</code></a>s into a <a href="#ArchetypeBuildingModel.BuildingNodeNetwork"><code>BuildingNodeNetwork</code></a> dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L7-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.create_building_weather" href="#ArchetypeBuildingModel.create_building_weather"><code>ArchetypeBuildingModel.create_building_weather</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_building_weather(
    archetype::Object,
    scopedata::ScopeData;
    ignore_year::Bool = false,
    repeat::Bool = true,
    save_layouts::Bool = true,
    mod::Module = @__MODULE__,
)</code></pre><p>Try to create <code>building_weather</code> automatically using <code>ArchetypeBuildingWeather.py</code>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially tries to automatically fetch weather data from ERA5 using the <code>PYPSA/atlite</code> python library, and aggregate it according to the GIS data indicated via the <code>shapefile_path</code> and <code>raster_weight_path</code> parameters for the <code>building_stock</code> objects. The desired weather year needs to be indicated using the <code>building_archetype</code> <code>weather_year</code> parameter, and weighting is done based on the <code>building_scope</code>, the shapefile at <code>shapefile_path</code>, and the optional raster data at <code>raster_weight_path</code>.</p><p>The optional <code>ignore_year</code> and <code>repeat</code> keywords are used to control the corresponding flags of the created <code>SpineInterface.TimeSeries</code>. By default, the created <code>TimeSeries</code> are year-aware and repeating. The <code>save_layouts</code> keyword is used to control whether the layouts used for weighting the weather data are saved for diagnostics.</p><p>Returns a new <code>building_weather</code> object, as well as a dictionary containing its parameter values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_weather.jl#L148-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.initialize_result_relationship_classes!" href="#ArchetypeBuildingModel.initialize_result_relationship_classes!"><code>ArchetypeBuildingModel.initialize_result_relationship_classes!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize_result_relationship_classes!(mod::Module)</code></pre><p>Initialize <code>RelationshipClass</code>es for storing heating and HVAC demand results in <code>mod</code>.</p><p>Note that this function modifies <code>mod</code> directly!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/main.jl#L171-L177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.run_input_data_tests" href="#ArchetypeBuildingModel.run_input_data_tests"><code>ArchetypeBuildingModel.run_input_data_tests</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run_input_data_tests(mod::Module = @__MODULE__)</code></pre><p>Runs input data tests for the Datastore loaded to module <code>mod</code>, <code>@__MODULE__</code> by default.</p><p>Essentially performs the following steps:</p><ol><li>Call <a href="#ArchetypeBuildingModel.run_object_class_tests"><code>run_object_class_tests</code></a></li><li>Call <a href="#ArchetypeBuildingModel.run_parameter_tests"><code>run_parameter_tests</code></a></li><li>Call <a href="#ArchetypeBuildingModel.run_structure_type_tests"><code>run_structure_type_tests</code></a></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/main.jl#L7-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.run_object_class_tests" href="#ArchetypeBuildingModel.run_object_class_tests"><code>ArchetypeBuildingModel.run_object_class_tests</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run_object_class_tests(mod::Module = @__MODULE__; limit::Real = Inf)</code></pre><p>Run tests for archetype building model definition <code>ObjectClasses</code> for module <code>mod</code>. The <code>limit</code> keyword can be used to limit the number of tests run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/tests.jl#L112-L117">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.run_parameter_tests" href="#ArchetypeBuildingModel.run_parameter_tests"><code>ArchetypeBuildingModel.run_parameter_tests</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run_parameter_tests(mod::Module = @__MODULE__; limit::Real = Inf)</code></pre><p>Run tests for archetype building model definition <code>Parameters</code> for module <code>mod</code>. The <code>limit</code> keyword can be used to limit the number of tests run.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/tests.jl#L8-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.run_structure_type_tests" href="#ArchetypeBuildingModel.run_structure_type_tests"><code>ArchetypeBuildingModel.run_structure_type_tests</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run_structure_type_tests(mod::Module = @__MODULE__)</code></pre><p>Ensure that <code>structure_type</code> contains the correct objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/tests.jl#L156-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.solve_archetype_building_hvac_demand" href="#ArchetypeBuildingModel.solve_archetype_building_hvac_demand"><code>ArchetypeBuildingModel.solve_archetype_building_hvac_demand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_archetype_building_hvac_demand(
    archetype_dictionary::Dict{Object,ArchetypeBuilding};
    free_dynamics::Bool = false,
    initial_temperatures::Dict{Object,Dict{Object,Float64}} = Dict{
        Object,
        Dict{Object,Float64}
    }(),
)</code></pre><p>Solve the <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> heating and cooling demand.</p><p>The <code>free_dynamics</code> keyword can be used to ignore node temperature limits, while the <code>initial_temperatures</code> keyword can be used to set desired initial temperatures for the nodes.</p><p>Essentially, performs the following steps:</p><ol><li>Create the <code>archetype_results_dictionary</code> by constructing the <a href="#ArchetypeBuildingModel.ArchetypeBuildingResults"><code>ArchetypeBuildingResults</code></a> for each entry in the <code>archetype_dictionary</code>.</li><li>Create the <code>results__building_archetype__building_node</code> <code>RelationshipClass</code> for storing temperature results.</li><li>Create the <code>results__building_archetype__building_process</code> <code>RelationshipClass</code> for storing HVAC results.</li><li>Return the <code>archetype_results_dictionary</code>, as well as the created <code>RelationshipClasses</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/main.jl#L124-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.write_to_url" href="#ArchetypeBuildingModel.write_to_url"><code>ArchetypeBuildingModel.write_to_url</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_to_url(url::String, input::ModelInput)</code></pre><p>Write model <code>input</code> data into the database at the <code>url</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/export.jl#L9-L13">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><p>This section lists all the internal types and functions not exported by the module.</p><h3 id="Types-2"><a class="docs-heading-anchor" href="#Types-2">Types</a><a class="docs-heading-anchor-permalink" href="#Types-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.AbstractNode" href="#ArchetypeBuildingModel.AbstractNode"><code>ArchetypeBuildingModel.AbstractNode</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractNode(
    building_node_network::BuildingNodeNetwork,
    node::Object,
    weather::WeatherData,
) &lt;: BuildingDataType</code></pre><p>Contain parameters defining a <code>node</code> in a model-agnostic manner.</p><p>Essentially, a <code>node</code> is a point in a commodity network where commodity balance is observed. <code>nodes</code> can have a <em>state</em>, which represents accumulated commodities at the point. The state of a <code>node</code> can &quot;bleed&quot; either outside the model scope via the <code>self_discharge_coefficient_W_K</code>, or into another <code>nodes</code> via the <code>heat_transfer_coefficients_W_K</code>. The <code>external_load</code> represents uncontrollable external influence affecting the <code>node</code>, e.g. commodity demand or gains.</p><p>This struct contains the following fields:</p><ul><li><code>building_node::Object</code>: The <code>building_node</code> definition this <code>AbstractNode</code> depicts.</li><li><code>thermal_mass_Wh_K::SpineDataType</code>: The effective thermal mass of this node in [Wh/K].</li><li><code>self_discharge_coefficient_W_K::SpineDataType</code>: The self-discharge coefficient in [W/K] from this node.</li><li><code>heat_transfer_coefficients_W_K::Dict{Object,SpineDataType}</code>: The heat transfer coefficients between this node and other nodes in [W/K].</li><li><code>external_load::SpineDataType</code>: Heat loads/gains on this node due to external influende, e.g. ambient conditions, inhabitants, solar irradiation, etc.</li><li><code>minimum_temperature_K::SpineDataType</code>: Minimum permitted temperature of the node in [K].</li><li><code>maximum_temperature_K::SpineDataType</code>: Maximum permitted temperature of the node in [K].</li></ul><p>The constructor calls the <a href="#ArchetypeBuildingModel.process_abstract_node"><code>process_abstract_node</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L540-L567">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.AbstractNodeNetwork" href="#ArchetypeBuildingModel.AbstractNodeNetwork"><code>ArchetypeBuildingModel.AbstractNodeNetwork</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractNodeNetwork::Dict{Object,AbstractNode}</code></pre><p><code>Dict</code> mapping <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>s to their corresponding <code>building_node</code>s. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L595-L599">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.AbstractProcess" href="#ArchetypeBuildingModel.AbstractProcess"><code>ArchetypeBuildingModel.AbstractProcess</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractProcess(process_data::BuildingProcessData; mod::Module = @__MODULE__) &lt;: BuildingDataType</code></pre><p>Contain parameters defining a <code>process</code> in a model-agnostic manner.</p><p>Essentially, a <code>process</code> is a commodity transfer/conversion from one <code>node</code> to another. For the purposes of the <code>ArchetypeBuildingModel.jl</code>, <code>processes</code> only have two attributes of interest: The ratio between total input and total output, and the maximum flows to and from the connected <code>nodes</code>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>building_process::Object</code>: The <code>building_process</code> definition this <code>AbstractProcess</code> depicts.</li><li><code>coefficient_of_performance::SpineDataType</code>: The coefficient of performance of this process.</li><li><code>maximum_flows_W::Dict{Tuple{Object,Object},SpineDataType}</code>: The maximum flows to/from this process in [W].</li></ul><p>The constructor calls the <a href="#ArchetypeBuildingModel.process_abstract_system"><code>process_abstract_system</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L603-L623">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.BuildingDataType" href="#ArchetypeBuildingModel.BuildingDataType"><code>ArchetypeBuildingModel.BuildingDataType</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BuildingDataType</code></pre><p>Abstract type for ArchetypeBuildingModel data structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.BuildingNodeData" href="#ArchetypeBuildingModel.BuildingNodeData"><code>ArchetypeBuildingModel.BuildingNodeData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BuildingNodeData(
    archetype::Object,
    node::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    loads::LoadsData;
    mod::Module = @__MODULE__,
) &lt;: BuildingDataType</code></pre><p>Contains data about how the structures and systems are aggregated into nodes for the lumped-capacitance thermal model.</p><p>The <code>BuildingNodeData</code> struct aims to remain as human-readable as possible, making it a high-level description for what the lumped-capacitance node contains. Ultimately, <code>BuildingNodeData</code>s are converted into <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>s for exporting into energy-system-model-specific input data formats.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>This struct contains the following fields:</p><ul><li><code>building_node::Object</code>: The <code>building_node</code> definition used for this <code>BuildingNodeData</code>.</li><li><code>thermal_mass_base_J_K::SpineDataType</code>: Optional user-defined base effective thermal mass in [J/K] of the temperature node.</li><li><code>thermal_mass_gfa_scaled_J_K::SpineDataType</code>: Optional user-defined gross-floor-area-scaling effective thermal mass in [J/m2K] of the temperature node.</li><li><code>thermal_mass_interior_air_and_furniture_J_K::Float64</code>: The effective thermal mass contribution of the interior air and furniture on this temperature node.</li><li><code>thermal_mass_structures_J_K::Float64</code>: The effective thermal mass contribution of included structures on this temperature node.</li><li><code>maximum_temperature_K::SpineDataType</code>: The maximum permitted temperature of the node.</li><li><code>minimum_temperature_K::SpineDataType</code>: The minimum permitted temperature of the node.</li><li><code>self_discharge_base_W_K::SpineDataType</code>: Optional user-defined base self-discharge rate in [W/K] of the temperature node.</li><li><code>self_discharge_gfa_scaled_W_K::SpineDataType</code>: Optional user-defined gross-floor-area-scaling self-discharge rate in [W/m2K] of the temperature node.</li><li><code>heat_transfer_coefficients_base_W_K::Dict{Object,SpineDataType}</code>: Optional user-defined base heat transfer coefficients between this node and other temperature nodes.</li><li><code>heat_transfer_coefficients_gfa_scaled_W_K::Dict{Object,SpineDataType}</code>: Optional user-defined gross-floor-area-scaling heat transfer coefficients between this node and other temperature nodes.</li><li><code>heat_transfer_coefficient_structures_interior_W_K::Float64</code>: The contribution of included structures on the heat transfer coefficient between this node and the interior air node.</li><li><code>heat_transfer_coefficient_structures_exterior_W_K::Float64</code>: The contribution of included structures on the heat transfer coefficients between this node and the ambient temperature.</li><li><code>heat_transfer_coefficient_structures_ground_W_K::Float64</code>: The contribution of included structures on the heat transfer coefficient between this node and the effective ground temperature.</li><li><code>heat_transfer_coefficient_windows_W_K::Float64</code>: Contribution of windows to the heat transfer coefficient from this node to the ambient air.</li><li><code>heat_transfer_coefficient_ventilation_and_infiltration_W_K::Float64</code>: Contribution of infiltration and ventilation on the heat transfer coefficient between this node and the ambient air.</li><li><code>heat_transfer_coefficient_thermal_bridges_W_K::Float64</code>: Contribution of linear thermal bridges on the heat transfer coefficient between this node and the ambient air.</li><li><code>domestic_hot_water_demand_W::SpineDataType</code>: Domestic hot water demand in [W] on this node.</li><li><code>internal_heat_gains_air_W::SpineDataType</code>: Convective part of internal heat gains on this node in [W].</li><li><code>internal_heat_gains_structures_W::SpineDataType</code>: Radiative part of internal heat gains on this node in [W].</li><li><code>solar_heat_gains_air_W::SpineDataType</code>: Convective part of solar heat gains on this node in [W].</li><li><code>solar_heat_gains_structures_W::SpineDataType</code>: Radiative part of solar heat gains on this node in [W].</li><li><code>interior_air_and_furniture_weight::Float64</code>: The defined share of interior air and furniture assigned to this node.</li></ul><p>The constructor calls the <a href="#ArchetypeBuildingModel.process_building_node"><code>process_building_node</code></a> function, and checks the values are sensible.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L358-L405">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.BuildingNodeNetwork" href="#ArchetypeBuildingModel.BuildingNodeNetwork"><code>ArchetypeBuildingModel.BuildingNodeNetwork</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BuildingNodeNetwork::Dict{Object,BuildingNodeData}</code></pre><p><code>Dict</code> mapping <a href="#ArchetypeBuildingModel.BuildingNodeData"><code>BuildingNodeData</code></a> to their corresponding <code>building_node</code> <code>Object</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L467-L471">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.StructureData" href="#ArchetypeBuildingModel.StructureData"><code>ArchetypeBuildingModel.StructureData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StructureData &lt;: BuildingDataType</code></pre><p>Store the important aggregated parameters for a structure type.</p><p>This type is used by the <a href="#ArchetypeBuildingModel.process_structure_scope"><code>process_structure_scope</code></a> function to store the gross-floor-area-averaged structural properties within the desired <code>scope</code>. Contains the following fields:</p><ul><li><code>structure_type::Object</code>: Type of the structure, e.g. <code>base_floor</code> or <code>roof</code>.</li><li><code>design_U_value_W_m2K::Float64</code>: Design U-value of the structure in [W/m2K].</li><li><code>effective_thermal_mass_J_m2K::Float64</code>: Effective thermal mass of the structure in [J/m2K].</li><li><code>external_U_value_to_ambient_air_W_m2K::Float64</code>: U-value from the structure to ambient air in [W/m2K].</li><li><code>external_U_value_to_ground_W_m2K::Float64</code>: U-value from the structure to ground in [W/m2K].</li><li><code>internal_U_value_to_structure_W_m2K::Float64</code>: U-value from the structure to the interior air in [W/m2K].</li><li><code>linear_thermal_bridges_W_mK::Float64</code>: Linear thermal bridges in the structure in [W/mK].</li><li><code>total_U_value_W_m2K::Float64</code>: Total U-value through the structure.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/types.jl#L15-L31">source</a></section></article><h3 id="Functions-2"><a class="docs-heading-anchor" href="#Functions-2">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel._building_period_weight" href="#ArchetypeBuildingModel._building_period_weight"><code>ArchetypeBuildingModel._building_period_weight</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_building_period_weight(building_period::Object, building_scope::Object; mod::Module = @__MODULE__)</code></pre><p>Calculate the weight of a <code>building_period</code> within a <code>building_scope</code>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, represents whether the <a href="../archetype_definitions/#building_period">building_period</a> <code>bp</code> is contained within <a href="../archetype_definitions/#scope_period_start_year">scope_period_start_year</a> – <a href="../archetype_definitions/#scope_period_end_year">scope_period_end_year</a> in its entirety [1], only partially (0,1), or if at all [0].</p><p class="math-container">\[w_\text{bp} = \text{max}\left( \text{min} \left( \frac{\text{end}_\text{scope} - \text{start}_\text{bp}}{\text{end}_\text{bp} - \text{start}_\text{bp}}, \frac{\text{end}_\text{bp} - \text{start}_\text{scope}}{\text{end}_\text{bp} - \text{start}_\text{bp}}, 1 \right), 0 \right)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_scope.jl#L80-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel._pyseries_to_timeseries" href="#ArchetypeBuildingModel._pyseries_to_timeseries"><code>ArchetypeBuildingModel._pyseries_to_timeseries</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_pyseries_to_timeseries(
    pyseries::PyCall.PyObject;
    ignore_year::Bool = false,
    repeat::Bool = true,
)</code></pre><p>Convert <code>ArchetypeBuildingWeather.py</code> output <code>pandas.Series</code> into a <code>TimeSeries</code>.</p><p>The optional keywords can be used to tweak how the <code>TimeSeries</code> is flagged. Default is a year-aware repeating timeseries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_weather.jl#L239-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.add_archetype_to_input!" href="#ArchetypeBuildingModel.add_archetype_to_input!"><code>ArchetypeBuildingModel.add_archetype_to_input!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">add_archetype_to_input!(
    backbone::BackboneInput,
    archetype::ArchetypeBuilding,
    result::archetypeBuildingResults;
    mod::Module = @__MODULE__,
)</code></pre><p>Process and add the desired <code>archetype</code> building into the <code>backbone</code> input.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>This is a very long and rather complicated function, which essentially translates the information contained in the <code>archetype</code> <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> into the data structure in <code>backbone</code> <a href="#ArchetypeBuildingModel.BackboneInput"><code>BackboneInput</code></a>, so that it is understood by the Backbone energy system model. The key steps taken by this function are summarized below:</p><ol><li>Map the ArchetypeBuildingModel <code>direction</code> objects to Backbone <code>io</code> objects.</li><li>Map the ArchetypeBuildingModel <code>building_node</code> objects to unique Backbone <code>node</code> objects.</li><li>Identify the necessary <em>system link nodes</em>, and add them into the set of Backbone <code>node</code> objects with the desired names.</li><li>Include all <code>node</code>s to the <code>building</code> <code>grid</code>, and connect the <em>system link nodes</em> to their desired <code>grid</code>s.</li><li>Map the ArchetypeBuildingModel <code>building_process</code> objects to unique Backbone <code>unit</code> objects.</li><li>Determine Backbone <code>unit</code> parameters based on <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a> properties.</li><li>Set the <code>directOff</code> efficiency representation for all <code>unit</code>s.</li><li>Determine Backbone <code>grid__node</code> parameters based on <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> properties.</li><li>Determine Backbone <code>grid__node__boundary</code> parameters based on <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> maximum and minimum permitted temperatures.</li><li>Determine Backbone <code>grid__node__node</code> parameters based on <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> heat transfer coefficients.</li><li>Determine Backbone <code>grid__node__unit__io</code> parameters based on <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a> maximum flows.</li><li>Set the <code>HVAC</code> <code>unittype</code> for every <code>unit</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/create_backbone_input.jl#L141-L171">source</a></section><section><div><pre><code class="nohighlight hljs">add_archetype_to_input!(
    spineopt::SpineOptInput,
    archetype::ArchetypeBuilding,
    result::ArchetypeBuildingResults;
    mod::Module = @__MODULE__,
)</code></pre><p>Process and add the desired <code>archetype</code> building with <code>result</code> into the <code>spineopt</code> input.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>This is a very long and rather complicated function, which essentially translates the information contained in the <code>archetype</code> <a href="#ArchetypeBuildingModel.ArchetypeBuilding"><code>ArchetypeBuilding</code></a> into the data structure in <code>spineopt</code> <a href="#ArchetypeBuildingModel.SpineOptInput"><code>SpineOptInput</code></a>, so that it is understood by the SpineOpt energy system model. The key steps taken by this function are summarized below:</p><ol><li>Map the ArchetypeBuildingModel <code>building_node</code> objects to unique SpineOpt <code>node</code> objects.</li><li>Identify the necessary <em>system link nodes</em>, and add them into the set of SpineOpt <code>node</code> objects with the desired names.</li><li>Map the ArchetypeBuildingModel <code>building_process</code> objects to unique SpineOpt <code>unit</code> objects.</li><li>Determine SpineOpt <code>node</code> parameters based on the <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> properties.</li><li>Determine SpineOpt <code>node__node</code> parameters based on the <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> heat transfer coefficients.</li><li>Determine SpineOpt <code>unit__from_node</code> and <code>unit__to_node</code> parameters based on the <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a> maximum flow parameters.</li><li>Determine SpineOpt <code>unit__node__node</code> parameters based on the <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a> properties.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/create_spineopt_input.jl#L80-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.aggregate_gfa_weights" href="#ArchetypeBuildingModel.aggregate_gfa_weights"><code>ArchetypeBuildingModel.aggregate_gfa_weights</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">aggregate_gfa_weights(gross_floor_area_weights::Dict{NTuple{5,Object},Float64})</code></pre><p>Aggregate <code>gross_floor_area_weights</code> for ventilation/infiltration and weather data processing.</p><p>Essentially, sums over the gross-floor area weights of unused dimensions to produce reduced sets of weights.</p><p class="math-container">\[w_\text{bt,bp,lid} = \sum_\text{bp,hs} w_\text{bs,bt,bp,lid,hs} \\
w_\text{lid} = \sum_\text{bt,bp} w_\text{bt,bp,lid},\]</p><p>where <code>w_bs,bt,bp,lid,hs</code> are the full gross-floor area weights calculated using <a href="#ArchetypeBuildingModel.calculate_gross_floor_area_weights"><code>calculate_gross_floor_area_weights</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_scope.jl#L225-L238">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_base_floor_dimensions" href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>ArchetypeBuildingModel.calculate_base_floor_dimensions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_base_floor_dimensions(
    data::ScopeData,
    storeys::Real,
    frame_depth_m::Real
)</code></pre><p>Calculate the base floor dimensions, assuming a rectangular building.</p><p>Essentially, calculates the surface area of the base floor in [m2] <code>A_bf</code>, as well as the thermal bridge length [m] <code>l_bf</code> based on the known gross-floor area (GFA), the assumed number of storeys, and the assumed frame depth of the building. The thermal bridge length is simply assumed to correspond to the length of the perimeter of the base floor.</p><p class="math-container">\[A_\text{bf} = \frac{A_\text{GFA}}{n_\text{storeys}}, \\
l_\text{bf} = 2 \left( \frac{A_\text{bf}}{d_\text{frame}} + d_\text{frame} \right),\]</p><p>where <code>A_GFA</code> is the gross-floor area of the building in [m2] based on the <a href="#ArchetypeBuildingModel.ScopeData"><code>ScopeData</code></a>, <code>n_storeys</code> is the assumed <a href="../archetype_definitions/#number_of_storeys">number_of_storeys</a>, and <code>d_frame</code> is the assumed <a href="../archetype_definitions/#building_frame_depth_m">building_frame_depth_m</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L98-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_cop" href="#ArchetypeBuildingModel.calculate_cop"><code>ArchetypeBuildingModel.calculate_cop</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_cop(
    weather::WeatherData,
    COP_mode::Symbol,
    process::Object;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the potentially time-varying coefficient of performance.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Uses the given <code>COP_mode</code>, <code>sink_temperature_K</code>, and <code>source_temperature_K</code> to calculate a potentially weather-dependent coefficient of performance. Based on the exergetic approach in EN 15316-4-2:2017 Annex D, where a known reference COP is extrapolated to unknown temperature ranges using the Carnot COP.</p><p class="math-container">\[\text{COP}_{T_\text{in}, T_\text{out}} = \text{COP}_\text{base} \frac{T_\text{out}}{T_\text{out} - T_\text{in}}, \\
\text{where } \text{COP}_\text{base} = \frac{\text{COP}_\text{ref}}{\text{COP}_\text{carnot,ref}}\]</p><p>If the source and sink temperatures are undefined, returns the defined base COP as the COP is assumed to be weather independent. See the <code>archetype_definitions.json</code> default values for <code>sink_temperature_K</code> and <code>source_temperature_K</code> for the different options how the COP can be made dependent on the <code>weather</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_system.jl#L74-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_convective_internal_heat_gains" href="#ArchetypeBuildingModel.calculate_convective_internal_heat_gains"><code>ArchetypeBuildingModel.calculate_convective_internal_heat_gains</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_convective_internal_heat_gains(
    archetype::Object
    loads::LoadsData,
    interior_weight::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the convective internal heat gains on the <code>node</code> in [W].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, takes the given internal heat gain profile in <code>loads</code> and multiplies it with the share of interior air on this <code>node</code> as well as the assumed convective fraction of internal heat gains.</p><p class="math-container">\[\Phi_\text{int,conv,n} = w_\text{int,n} f_\text{int,conv} \Phi_\text{int}\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> of this node, <code>f_int,conv</code> is the assumed <a href="../archetype_definitions/#internal_heat_gain_convective_fraction">internal_heat_gain_convective_fraction</a>, and <code>Φ_int</code> are the total internal heat gains of the building. See <a href="#ArchetypeBuildingModel.calculate_total_internal_heat_loads"><code>calculate_total_internal_heat_loads</code></a> for how the total internal heat loads are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L653-L677">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_convective_solar_gains" href="#ArchetypeBuildingModel.calculate_convective_solar_gains"><code>ArchetypeBuildingModel.calculate_convective_solar_gains</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_convective_solar_gains(
    archetype::Object
    loads::LoadsData,
    interior_weight::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the convective solar heat gains on the <code>node</code> in [W].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, takes the given solar heat gain profile in <code>loads</code> and multiplies it with the share of interior air on this <code>node</code> as well as the assumed convective fraction of solar heat gains.</p><p class="math-container">\[\Phi_\text{sol,conv,n} = w_\text{int,n} f_\text{sol,conv} \Phi_\text{sol}\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> of this node, <code>f_sol,conv</code> is the assumed <a href="../archetype_definitions/#solar_heat_gain_convective_fraction">solar_heat_gain_convective_fraction</a>, and <code>Φ_sol</code> are the total solar heat gains into the building. See <a href="#ArchetypeBuildingModel.calculate_total_solar_gains"><code>calculate_total_solar_gains</code></a> for how the total solar heat gains are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L739-L763">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_effective_ground_temperature" href="#ArchetypeBuildingModel.calculate_effective_ground_temperature"><code>ArchetypeBuildingModel.calculate_effective_ground_temperature</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_effective_ground_temperature(
    ambient_temp_K::SpineDataType;
    coeff::Real=1.7
)</code></pre><p>Calculate the effective ground temperature based on the ambient temperature.</p><p>The method used in this function is based on  <em>Kissock et al., Simplified Model for Ground Heat Transfer from Slab-on-Grade buildings, ASHRAE Transactions 2013</em></p><p class="math-container">\[\frac{a * T_\text{ambient annual average} + T_\text{ambient 3-month moving average}}{1 + a},\]</p><p>where the default <code>coeff</code> is <code>a=1.7</code>.</p><p><em>NOTE!</em> The ambient temperature timeseries is assumed to repeat when calculating the annual and 3-month moving averages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_weather.jl#L71-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_exterior_wall_dimensions" href="#ArchetypeBuildingModel.calculate_exterior_wall_dimensions"><code>ArchetypeBuildingModel.calculate_exterior_wall_dimensions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_exterior_wall_dimensions(
    vertical_envelope_area_m2::Real,
    window::NamedTuple,
    load_bearing_fraction::Real,
    storeys::Real,
    room_height_m::Real
)</code></pre><p>Calculate the dimensions of exterior walls, assuming a rectangular building.</p><p>The exterior wall surface area [m2] <code>A_ewlb</code> is calculated simply as the difference between vertical envelope area and the window surface area. The linear thermal bridge length [m] includes the corners of the exterior walls. The results are provided for load-bearing and light exterior walls separately, based on the assumed load-bearing fraction of the external walls.</p><p class="math-container">\[A_\text{ewlb} = f_\text{lb} \left( A_\text{vertical envelope} - A_\text{w} \right), \\
l_\text{ewlb} = 4 f_\text{lb} \lceil n_\text{storeys} \rceil h_\text{room}\]</p><p>where <code>f_lb</code> is the assumed <a href="../archetype_definitions/#external_wall_load_bearing_fraction">external_wall_load_bearing_fraction</a>, <code>A_vertical_envelope</code> is the vertical envelope surface area of the building, <code>A_w</code> is the window surface area, <code>n_storeys</code> is the assumed <a href="../archetype_definitions/#number_of_storeys">number_of_storeys</a>, and <code>h_room</code> is the assumed <a href="../archetype_definitions/#room_height_m">room_height_m</a>. See <a href="#ArchetypeBuildingModel.calculate_vertical_envelope_surface_area"><code>calculate_vertical_envelope_surface_area</code></a> and <a href="#ArchetypeBuildingModel.calculate_window_dimensions"><code>calculate_window_dimensions</code></a> for how the vertical envelope and window areas are calculated.</p><p>The dimensions of light exterior walls are calculated similarly to the above, except that <code>(1-f_lb)</code> is used as the coefficient instead.</p><p>Returns the load-bearing exterior wall dimensions first, and the light exterior wall dimensions second.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L295-L329">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_gross_floor_area_weights" href="#ArchetypeBuildingModel.calculate_gross_floor_area_weights"><code>ArchetypeBuildingModel.calculate_gross_floor_area_weights</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_gross_floor_area_weights(
    scope::Object,
    relevant_building_stock_statistics::Vector,
    building_period_weights::Dict{Object,T} where T &lt;: Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the gross-floor area weights for the <code>relevant_building_stock_statistics</code>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, returns a normalized weight for each relevant entry in the input data statistics, corresponding to how impactful it is when aggregating the properties for the given <code>scope</code>. The weights of the individual dimensions are assumed to be one, unless otherwise specified in <a href="../defining_archetype_buildings/#The-building_scope-definition">The <code>building_scope</code> definition</a>. Also returns the total number of buildings and the total weighted gross-floor area included in the <code>building_scope</code>.</p><p class="math-container">\[w_\text{bs,bt,bp,lid,hs} = \frac{w_\text{bs} w_\text{bt} w_\text{bp} w_\text{lid} w_\text{hs} n_\text{bs,bt,bp,lid,hs} A_\text{gfa,bs,bt,bp,lid,hs}}{\sum_{bs,bt,bp,lid,hs} w_\text{bs,bt,bp,lid,hs}}\]</p><p>where <code>w_bs</code> is the <a href="../archetype_definitions/#building_stock_weight">building_stock_weight</a>, <code>w_bt</code> is the <a href="../archetype_definitions/#building_type_weight">building_type_weight</a>, <code>w_bp</code> is the <a href="#ArchetypeBuildingModel._building_period_weight"><code>_building_period_weight</code></a>, <code>w_lid</code> is the <a href="../archetype_definitions/#location_id_weight">location_id_weight</a>, <code>w_hs</code> is the <a href="../archetype_definitions/#heat_source_weight">heat_source_weight</a>, <code>n_bs,bt,bp,lid,hs</code> is the <a href="../archetype_definitions/#number_of_buildings">number_of_buildings</a>, and <code>A_gfa</code> is the <a href="../archetype_definitions/#average_gross_floor_area_m2_per_building">average_gross_floor_area_m2_per_building</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_scope.jl#L126-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_interior_air_and_furniture_thermal_mass" href="#ArchetypeBuildingModel.calculate_interior_air_and_furniture_thermal_mass"><code>ArchetypeBuildingModel.calculate_interior_air_and_furniture_thermal_mass</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_interior_air_and_furniture_thermal_mass(
    archetype::Object,
    scope::ScopeData,
    interior_weight::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the effective thermal mass of interior air and furniture on <code>node</code> in [J/K].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, the calculation is based on the gross-floor area [m2] of the archetype building, the assumed effective thermal capacity of interior air and furniture, and the assumed share of interior air and furniture weight  on the <code>node</code>.</p><p class="math-container">\[C_\text{int,n} = w_\text{int,n} c_\text{int,gfa} A_\text{gfa}\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> on this <a href="../archetype_definitions/#building_node">building_node</a>, <code>c_int,gfa</code> is the assumed <a href="../archetype_definitions/#effective_thermal_capacity_of_interior_air_and_furniture_J_m2K">effective_thermal_capacity_of_interior_air_and_furniture_J_m2K</a>, and <code>A_gfa</code> is the gross-floor area of the building.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L288-L312">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_total_thermal_bridge_heat_transfer_coefficient" href="#ArchetypeBuildingModel.calculate_total_thermal_bridge_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_total_thermal_bridge_heat_transfer_coefficient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_total_thermal_bridge_heat_transfer_coefficient(
    archetype::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    interior_weight::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate total thermal bridge heat transfer coefficient.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Thermal bridges are assumed to bypass the temperature node within the structure, and act as direct heat transfer between the indoor air and ambient conditions.</p><p class="math-container">\[H_{\Psi,n} = w_\text{int,n} \left( \Delta U_\text{w,tb} A_w + \sum_\text{st} \left[ l_\text{st} \Psi_\text{st} \right] \right)\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> of this node, <code>ΔU_w,tb</code> is the <a href="../archetype_definitions/#window_area_thermal_bridge_surcharge_W_m2K">window_area_thermal_bridge_surcharge_W_m2K</a>, <code>A_w</code> is the window surface area based on <a href="#ArchetypeBuildingModel.calculate_window_dimensions"><code>calculate_window_dimensions</code></a>, <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a>, <code>l_st</code> is the length of the linear thermal bridge of structure <code>st</code>, and <code>Ψ_st</code> is the <a href="../archetype_definitions/#linear_thermal_bridges_W_mK">linear_thermal_bridges_W_mK</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L607-L632">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_partition_wall_dimensions" href="#ArchetypeBuildingModel.calculate_partition_wall_dimensions"><code>ArchetypeBuildingModel.calculate_partition_wall_dimensions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_partition_wall_dimensions(
    vertical_envelope_area_m2::Real,
    partition_wall_ratio::Real,
    load_bearing_fraction::Real
)</code></pre><p>Calculate the partition wall dimensions, assuming a rectangular building.</p><p>The <em>one-sided</em> partition wall surface area [m2] is calculated based on the vertical envelope area of the building, and the assumed ratio between partition walls and vertical envelope. The linear thermal bridge length [m] is set to zero, as producing any actual estimation would require a lot more information about the layout of the building. The results are provided for load-bearing and light exterior walls separately, based on the assumed load-bearing faction.</p><p class="math-container">\[A_\text{pwlb} = f_\text{lb} r_\text{pw} A_\text{vertical envelope}, \\
l_\text{pwlb} = 0\]</p><p>where <code>f_lb</code> is the assumed <a href="../archetype_definitions/#partition_wall_load_bearing_fraction">partition_wall_load_bearing_fraction</a>, <code>r_pw</code> is the assumed <a href="../archetype_definitions/#partition_wall_length_ratio_to_external_walls_m_m">partition_wall_length_ratio_to_external_walls_m_m</a>, and <code>A_vertical_envelope</code> is the vertical envelope area of the building. See <a href="#ArchetypeBuildingModel.calculate_vertical_envelope_surface_area"><code>calculate_vertical_envelope_surface_area</code></a> for how the vertical envelope area is calculated.</p><p>The dimensions of light partition walls are calculated similarly to the above, except that <code>(1-f_lb)</code> is used as the coefficient instead.</p><p>Returns the load-bearing partition wall dimensions first, and the light partition wall dimensions second.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L351-L382">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_radiative_internal_heat_gains" href="#ArchetypeBuildingModel.calculate_radiative_internal_heat_gains"><code>ArchetypeBuildingModel.calculate_radiative_internal_heat_gains</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_radiative_internal_heat_gains(
    archetype::Object,
    node::Object,
    envelope::EnvelopeData,
    loads::LoadsData,
    total_structure_area_m2::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the radiative internal heat gains on the <code>node</code> in [W].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, takes the given internal heat gain profile in <code>loads</code> and multiplies it with the assumed radiative fraction of internal heat gains. The radiative heat gains are assumed to be distributed across the structures  simply based on their relative surface areas. Note that currently, radiative internal heat gains are partially lost through windows!</p><p class="math-container">\[\Phi_\text{int,rad,n} = (1 - f_\text{int,conv}) \frac{\sum_{\text{st} \in n} A_\text{st}}{\sum_{\text{st}} A_\text{st}} \Phi_\text{int}\]</p><p>where <code>f_int,conv</code> is the assumed <a href="../archetype_definitions/#internal_heat_gain_convective_fraction">internal_heat_gain_convective_fraction</a>, <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a> and <code>n</code> is this <a href="../archetype_definitions/#building_node">building_node</a>, <code>A_st</code> is the surface area of structure <code>st</code>, and <code>Φ_int</code> are the total internal heat gains of the building. See <a href="#ArchetypeBuildingModel.calculate_total_internal_heat_loads"><code>calculate_total_internal_heat_loads</code></a> for how the total internal heat loads are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L690-L719">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_radiative_solar_gains" href="#ArchetypeBuildingModel.calculate_radiative_solar_gains"><code>ArchetypeBuildingModel.calculate_radiative_solar_gains</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_radiative_solar_gains(
    archetype::Object,
    node::Object,
    envelope::EnvelopeData,
    loads::LoadsData,
    total_structure_area_m2::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the radiative solar heat gains on the <code>node</code> in [W].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, takes the given solar heat gain profile in <code>loads</code> and multiplies it with the assumed radiative fraction of solar heat gains. The radiative heat gains are assumed to be distributed across the structures  simply based on their relative surface areas. Note that currently, radiative solar heat gains are partially lost through windows!</p><p class="math-container">\[\Phi_\text{sol,rad,n} = (1 - f_\text{sol,conv}) \frac{\sum_{\text{st} \in n} A_\text{st}}{\sum_{\text{st}} A_\text{st}} \Phi_\text{sol}\]</p><p>where <code>f_sol,conv</code> is the assumed <a href="../archetype_definitions/#solar_heat_gain_convective_fraction">solar_heat_gain_convective_fraction</a>, <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a> and <code>n</code> is this <a href="../archetype_definitions/#building_node">building_node</a>, <code>A_st</code> is the surface area of structure <code>st</code>, and <code>Φ_sol</code> are the total solar heat gains into the building. See <a href="#ArchetypeBuildingModel.calculate_total_solar_gains"><code>calculate_total_solar_gains</code></a> for how the total solar heat gains are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L776-L805">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_roof_dimensions" href="#ArchetypeBuildingModel.calculate_roof_dimensions"><code>ArchetypeBuildingModel.calculate_roof_dimensions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_roof_dimensions(
    base_floor::NamedTuple,
    storeys::Real,
    frame_depth_m::Real
)</code></pre><p>Calculate the roof dimensions assuming a rectangular building.</p><p>Essentially, calculates the surface area of the roof in [m2] <code>A_r</code>, as well as the thermal bridge length [m] <code>l_r</code> based on the dimensions of the base floor. The thermal bridge length is simply assumed to correspond to the length of the perimeter of the roof, and in case of a partial top floor, the roof is divided into two separate surfaces, thus increasing the thermal bridge length.</p><p class="math-container">\[A_\text{r} = A_\text{bf}, \\
l_\text{r} = \begin{cases}
l_\text{bf}, \qquad n_\text{storey} \in \mathbb{N} \\
l_\text{bf} + 2 d_\text{frame}, \qquad n_\text{storey} \notin \mathbb{N}
\end{cases}\]</p><p>where <code>A_bf</code> is the surface area of the base floor according to, <code>l_bf</code> is the thermal bridge <em>(perimeter)</em> length of the base floor, and <code>d_frame</code> is the assumed <a href="../archetype_definitions/#building_frame_depth_m">building_frame_depth_m</a>. See <a href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>calculate_base_floor_dimensions</code></a> for how the base floor dimensions are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L135-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_separating_floor_dimensions" href="#ArchetypeBuildingModel.calculate_separating_floor_dimensions"><code>ArchetypeBuildingModel.calculate_separating_floor_dimensions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_separating_floor_dimensions(
    data::ScopeData,
    base_floor::NamedTuple,
    storeys::Real,
    frame_depth_m::Real
)</code></pre><p>Calculate the separating floor dimensions assuming a rectangular building.</p><p>Essentially, calculates the <em>one-sided</em> surface area of the separating floors in [m2] <code>A_sf</code>, as well as the thermal bridge length [m] <code>l_sf</code> based on the known gross-floor area (GFA), the assumed number of storeys, and the dimensions of the base floor. The thermal bridge length is assumed to correspond to the length of the perimeter of the separating floors.</p><p class="math-container">\[A_\text{sf} = A_\text{GFA} - A_\text{bf}, \\
l_\text{sf} = \begin{cases}
\left( \lfloor n_\text{storeys} \rfloor - 1 \right) l_\text{bf}, \quad &amp; n_\text{storeys} \in \mathbb{N} \\
\left( \lfloor n_\text{storeys} \rfloor - 1 \right) l_\text{bf} + 2 \left( \frac{A_\text{bf} (n_\text{storeys} - \lfloor n_\text{storeys} \rfloor)}{d_\text{frame}} + d_\text{frame} \right), \quad &amp; n_\text{storeys} \notin \mathbb{N}
\end{cases}\]</p><p>where <code>A_GFA</code> is the gross-floor area of the building, <code>A_bf</code> is the surface area of the base floor, <code>n_storeys</code> is the assumed <a href="../archetype_definitions/#number_of_storeys">number_of_storeys</a>, <code>l_bf</code> is the linear thermal bridge <em>(perimeter)</em> length of the base floor, and <code>d_frame</code> is the assumed <a href="../archetype_definitions/#building_frame_depth_m">building_frame_depth_m</a>. See <a href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>calculate_base_floor_dimensions</code></a>) for how the base floor dimensions are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L178-L208">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_structural_exterior_heat_transfer_coefficient" href="#ArchetypeBuildingModel.calculate_structural_exterior_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_structural_exterior_heat_transfer_coefficient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_structural_exterior_heat_transfer_coefficient(
    node::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    interior_weight::Real
)</code></pre><p>Calculate the total exterior heat transfer coefficient of the structures in <code>node</code> in [W/K].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, calculates the total heat transfer coefficient between the ambient air and the node containing the structures. Internal structures have no exterior heat transfer coefficient, as they are assumed to not be part of the building envelope. If an external structure is lumped together with the interior air node, it&#39;s internal heat transfer coefficient is attributed to its exterior heat transfer as well, <em>but using this feature is not recommended</em>!</p><p class="math-container">\[H_\text{ext,n} = \sum_{\text{st} \in n} w_\text{n,st} \left( \frac{1}{U_\text{ext,st}} + \frac{w_{int,n}}{U_\text{int,st}} \right)^{-1} A_\text{st}\]</p><p>where <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a> and <code>n</code> is the <a href="../archetype_definitions/#building_node">building_node</a>, <code>w_n,st</code> is the <a href="../archetype_definitions/#structure_type_weight">structure_type_weight</a> of the structure <code>st</code> on this node, <code>U_ext,st</code> is the <a href="../archetype_definitions/#external_U_value_to_ambient_air_W_m2K">external_U_value_to_ambient_air_W_m2K</a> of structure <code>st</code>, <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> of this node, <code>U_int,st</code> is the <a href="../archetype_definitions/#internal_U_value_to_structure_W_m2K">internal_U_value_to_structure_W_m2K</a> of structure <code>st</code>, and <code>A_st</code> is the surface area of structure <code>st</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L427-L456">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_structural_ground_heat_transfer_coefficient" href="#ArchetypeBuildingModel.calculate_structural_ground_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_structural_ground_heat_transfer_coefficient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_structural_ground_heat_transfer_coefficient(
    archetype::Object,
    node::Object,
    scope::ScopeData,
    envelope::EnvelopeData;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the total ground heat transfer coefficient of the structures in <code>node</code> in [W/K].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, calculates the total heat transfer coefficient between the ground and the node containing the structures according to the simplified method proposed by K.Kissock in: <code>Simplified Model for Ground Heat Transfer from Slab-on-Grade Buildings, (c) 2013 ASHRAE</code></p><p class="math-container">\[H_\text{grn,n} = \left( 1 + \frac{d_\text{frame}^2}{A_\text{bf}} \right) \sum_{\text{st} \in n} w_\text{n,st} U_\text{grn,st} A_\text{st}\]</p><p>where <code>d_frame</code> is the assumed <a href="../archetype_definitions/#building_frame_depth_m">building_frame_depth_m</a>, <code>A_bf</code> is the area according to <a href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>calculate_base_floor_dimensions</code></a>, <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a> and <code>n</code> is the <a href="../archetype_definitions/#building_node">building_node</a>, <code>w_n,st</code> is the <a href="../archetype_definitions/#structure_type_weight">structure_type_weight</a> of the structure <code>st</code> on this node, <code>U_grn,st</code> is the <a href="../archetype_definitions/#external_U_value_to_ground_W_m2K">external_U_value_to_ground_W_m2K</a> of structure <code>st</code>, and <code>A_st</code> is the surface area of structure <code>st</code>. Note that the correction factor <code>C = (length + width) / length = 1 + d_frame^2 / A_bf</code> in the above equation assumes that <code>d_frame &lt; A_bf / d_frame</code>. If <code>d_frame &gt; A_bf / d_frame</code>, the correction term becomes <code>1 + A_bf / d_frame^2</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L480-L510">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_structural_interior_heat_transfer_coefficient" href="#ArchetypeBuildingModel.calculate_structural_interior_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_structural_interior_heat_transfer_coefficient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_structural_interior_heat_transfer_coefficient(
    node::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    interior_weight::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the total interior heat transfer coefficient of the structures in <code>node</code> in [W/K].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, initializes the total heat transfer coefficient between the interior air node and the node containing the structures. For internal structures, the U-values for both the interior and <em>exterior</em> surface are used, effectively accounting for both sides of interior structures. If an external structure is lumped together with the interior air node, it&#39;s internal heat transfer coefficient is attributed to its exterior heat transfer instead, <em>but using this feature is not recommended</em>!</p><p class="math-container">\[H_\text{int,n} = \begin{cases}
(1 - w_\text{int,n}) \sum_{\text{st} \in n} w_\text{n,st} U_\text{int,st} A_\text{st} \qquad \text{st} \notin \text{internal structures} \\
(1 - w_\text{int,n}) \sum_{\text{st} \in n} w_\text{n,st} ( U_\text{int,st} + U_\text{ext,st} ) A_\text{st} \qquad \text{st} \notin \text{internal structures}
\end{cases}\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> on this <a href="../archetype_definitions/#building_node">building_node</a> <code>n</code>, <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a>, <code>w_n,st</code> is the <a href="../archetype_definitions/#structure_type_weight">structure_type_weight</a> of the structure <code>st</code> on this node, <code>U_int,st</code> is the <a href="../archetype_definitions/#internal_U_value_to_structure_W_m2K">internal_U_value_to_structure_W_m2K</a> of structure <code>st</code>, and <code>A_st</code> is the surface area of structure <code>st</code>. A structure <code>st</code> is considered internal if the <a href="../archetype_definitions/#is_internal">is_internal</a> flag is true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L367-L402">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_structural_thermal_mass" href="#ArchetypeBuildingModel.calculate_structural_thermal_mass"><code>ArchetypeBuildingModel.calculate_structural_thermal_mass</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_structural_thermal_mass(
    node::Object,
    scope::ScopeData,
    envelope::EnvelopeData;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the effective thermal mass of the structures on <code>node</code> in [J/K].</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, sums the total effective thermal mass of the structures attributed to this node, accounting for their assigned weights.</p><p class="math-container">\[C_\text{n,str} = \sum_{\text{st} \in n} w_\text{n,st} c_\text{st} A_\text{st}\]</p><p>where <code>st</code> is the <a href="../archetype_definitions/#structure_type">structure_type</a> and <code>n</code> is the <a href="../archetype_definitions/#building_node">building_node</a>, <code>w_n,st</code> is the <a href="../archetype_definitions/#structure_type_weight">structure_type_weight</a> of the structure <code>st</code> on this node, <code>c_st</code>is the <a href="../archetype_definitions/#effective_thermal_mass_J_m2K">effective_thermal_mass_J_m2K</a> of the structure, and <code>A_st</code> is the surface area of the structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L327-L349">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_total_dhw_demand" href="#ArchetypeBuildingModel.calculate_total_dhw_demand"><code>ArchetypeBuildingModel.calculate_total_dhw_demand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_total_dhw_demand(loads::Object, scope::ScopeData; mod::Module = @__MODULE__)</code></pre><p>Calculate the total domestic hot water (DHW) demand.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, simply adds the fixed base DHW demand and the gross-floor-area-scaling DHW demand together for the given <code>loads</code> and <code>scope</code>.</p><p class="math-container">\[\Phi_\text{DHW} = \Phi_\text{DHW,base} + \phi_\text{DHW,gfa} A_\text{gfa}\]</p><p>where <code>Φ_DHW,base</code> is the assumed <a href="../archetype_definitions/#domestic_hot_water_demand_base_W">domestic_hot_water_demand_base_W</a>, <code>Φ_DHW,gfa</code> is the assumed <a href="../archetype_definitions/#domestic_hot_water_demand_gfa_scaling_W_m2">domestic_hot_water_demand_gfa_scaling_W_m2</a>, and <code>A_gfa</code> is the gross-floor area of the building.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_loads.jl#L50-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_total_internal_heat_loads" href="#ArchetypeBuildingModel.calculate_total_internal_heat_loads"><code>ArchetypeBuildingModel.calculate_total_internal_heat_loads</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_total_internal_heat_loads(
    loads::Object,
    scope::ScopeData;
    mod::Module = @__MODULE__
)</code></pre><p>Calculate the total internal heat gains.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, simply adds the fixed base internal gains and the gross-floor-area-scaling DHW demand together for the given <code>loads</code> and <code>scope</code>.</p><p class="math-container">\[\Phi_\text{int} = \Phi_\text{int,base} + \phi_\text{int,gfa} A_\text{gfa}\]</p><p>where <code>Φ_int,base</code> is the assumed <a href="../archetype_definitions/#internal_heat_loads_base_W">internal_heat_loads_base_W</a>, <code>Φ_int,gfa</code> is the assumed <a href="../archetype_definitions/#internal_heat_loads_gfa_scaling_W_m2">internal_heat_loads_gfa_scaling_W_m2</a>, and <code>A_gfa</code> is the gross-floor area of the building.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_loads.jl#L79-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_total_solar_gains" href="#ArchetypeBuildingModel.calculate_total_solar_gains"><code>ArchetypeBuildingModel.calculate_total_solar_gains</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_total_solar_gains(
    archetype::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    weather::WeatherData;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the total solar heat gains through the windows.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Loosely based on EN ISO 52016-1:2017 6.5.13.2, accounting for the solar heat gains through the windows of the building. Solar heat gains through the opaque parts of the building envelope are neglegted. The varying angle of incidence of the irradiation on the windows is accounted for using a very simple average non-perpendicularity factor. The frame-area fraction of the windows is accounted for in the solar energy transmittance, and window area distribution is handled using the shares towards cardinal directions.</p><p class="math-container">\[\Phi_\text{sol} = f_\text{np} g_\text{gl} A_\text{w} \left( I_\text{diff} + F_\text{shading} \sum_{d \in \text{N,E,S,W}} w_d I_\text{dir,d} \right)\]</p><p>where <code>f_np</code> is the assumed <a href="../archetype_definitions/#window_non_perpendicularity_correction_factor">window_non_perpendicularity_correction_factor</a>, <code>g_gl</code> is the <a href="../archetype_definitions/#total_normal_solar_energy_transmittance">total_normal_solar_energy_transmittance</a> of the glazing, <code>A_w</code> is the area of the windows, <code>I_diff</code> is the <a href="../archetype_definitions/#diffuse_solar_irradiation_W_m2">diffuse_solar_irradiation_W_m2</a>, <code>F_shading</code> is the assumed <a href="../archetype_definitions/#external_shading_coefficient">external_shading_coefficient</a>, <code>d</code> represents the cardinal directions, <code>w_d</code> is the <a href="../archetype_definitions/#window_area_distribution_towards_cardinal_directions">window_area_distribution_towards_cardinal_directions</a>, and <code>I_dir,d</code> is the <a href="../archetype_definitions/#direct_solar_irradiation_W_m2">direct_solar_irradiation_W_m2</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_loads.jl#L112-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_ventilation_and_infiltration_heat_transfer_coefficient" href="#ArchetypeBuildingModel.calculate_ventilation_and_infiltration_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_ventilation_and_infiltration_heat_transfer_coefficient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_ventilation_and_infiltration_heat_transfer_coefficient(
    archetype::Object,
    scope::ScopeData,
    interior_weight::Real;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate ventilation and infiltration heat transfer coefficient.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Ventilation and infiltration are assumed to transfer heat directly between the interior and ambient air. Loosely based on EN ISO 52016-1:2017 6.5.10.1.</p><p class="math-container">\[H_\text{ven,n} = w_\text{int,n} A_\text{gfa} h_\text{room} \rho_\text{air} \frac{ (1 - \eta_\text{hru}) r_\text{ven} + r_\text{inf}}{3600}\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> of this node, <code>A_gfa</code> is the gross-floor area of the building, <code>h_room</code> is the assumed <a href="../archetype_definitions/#room_height_m">room_height_m</a>, <code>ρ_air</code> is the assumed <a href="../archetype_definitions/#volumetric_heat_capacity_of_interior_air_J_m3K">volumetric_heat_capacity_of_interior_air_J_m3K</a>, <code>η_hru</code> is the <a href="../archetype_definitions/#HRU_efficiency">HRU_efficiency</a> <em>(heat recovery unit)</em>, <code>r_ven</code> is the <a href="../archetype_definitions/#ventilation_rate_1_h">ventilation_rate_1_h</a>, and <code>r_inf</code> is the <a href="../archetype_definitions/#infiltration_rate_1_h">infiltration_rate_1_h</a>. The division by 3600 accounts for the unit conversion from J to Wh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L561-L588">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_vertical_envelope_surface_area" href="#ArchetypeBuildingModel.calculate_vertical_envelope_surface_area"><code>ArchetypeBuildingModel.calculate_vertical_envelope_surface_area</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_vertical_envelope_surface_area(
    base_floor::NamedTuple,
    separating_floor::NamedTuple,
    room_height_m::Real,
)</code></pre><p>Calculate the vertical envelope surface area [m2] assuming a rectangular building.</p><p>An auxiliary function used for window and exterior wall calculations.</p><p class="math-container">\[A_\text{vertical envelope} = h_\text{room} \left( l_\text{bf} + l_\text{sf} \right)\]</p><p>where <code>h_room</code> is the assumed <a href="../archetype_definitions/#room_height_m">room_height_m</a>, <code>l_bf</code> is the linear thermal bridge <em>(perimeter)</em> length of the base floor, and <code>l_sf</code> is the linear thermal bridge <em>(perimeter)</em> length of any separating floors. See <a href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>calculate_base_floor_dimensions</code></a> and <a href="#ArchetypeBuildingModel.calculate_separating_floor_dimensions"><code>calculate_separating_floor_dimensions</code></a> for how the dimensions of the base and separating floors are calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L230-L249">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_window_dimensions" href="#ArchetypeBuildingModel.calculate_window_dimensions"><code>ArchetypeBuildingModel.calculate_window_dimensions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_window_dimensions(
    vertical_envelope_area_m2::Real,
    window_to_wall_ratio::Real
)</code></pre><p>Calculate the window dimensions assuming a rectangular building.</p><p>Calculates the window surface area [m2] <code>A_w</code> simply using the assumed window-to-wall ratio. The linear thermal bridge lenght <code>l_w</code> is set to zero, as it&#39;s not really applicable without significantly better information about the number and size of the individual windows.</p><p class="math-container">\[A_\text{w} = w A_\text{vertical envelope}, \\
l_\text{w} = 0\]</p><p>where <code>w</code> is the assumed <a href="../archetype_definitions/#window_area_to_external_wall_ratio_m2_m2">window_area_to_external_wall_ratio_m2_m2</a>, and <code>A_vertical_envelope</code> is the total vertical envelope area of the building. See <a href="#ArchetypeBuildingModel.calculate_vertical_envelope_surface_area"><code>calculate_vertical_envelope_surface_area</code></a> for how the vertical envelope area is calculated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L262-L283">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.calculate_window_heat_transfer_coefficient" href="#ArchetypeBuildingModel.calculate_window_heat_transfer_coefficient"><code>ArchetypeBuildingModel.calculate_window_heat_transfer_coefficient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_window_heat_transfer_coefficient(
    scope::ScopeData,
    envelope::EnvelopeData,
    interior_weight::Real
)</code></pre><p>Calculate the total heat transfer coefficient for windows.</p><p>Windows are assumed to transfer heat directly between the indoor air and the ambient air.</p><p class="math-container">\[H_\text{w,n} = w_\text{int,n} U_\text{w} A_\text{w}\]</p><p>where <code>w_int,n</code> is the <a href="../archetype_definitions/#interior_air_and_furniture_weight">interior_air_and_furniture_weight</a> of this node, <code>U_w</code> is the <a href="../archetype_definitions/#window_U_value_W_m2K">window_U_value_W_m2K</a>, and <code>A_w</code> is the surface area of the windows.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L536-L551">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.determine_temporal_structure" href="#ArchetypeBuildingModel.determine_temporal_structure"><code>ArchetypeBuildingModel.determine_temporal_structure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">determine_temporal_structure(archetype::ArchetypeBuilding)</code></pre><p>Check that <code>external_load</code> timeseries are consistent in the <code>AbstractNodeNetwork</code>, and determine the time series indices and the <code>delta_t</code>.</p><p>Note that the time series need to have a constant <code>delta_t</code> in order for the dynamic matrix to be time-invarying, speeding up the solving process significantly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L154-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.form_and_invert_dynamics_matrix" href="#ArchetypeBuildingModel.form_and_invert_dynamics_matrix"><code>ArchetypeBuildingModel.form_and_invert_dynamics_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">form_and_invert_dynamics_matrix(archetype::ArchetypeBuilding, delta_t::Int64)</code></pre><p>Forms and inverts the implicit Euler discretized dynamics matrix for the <code>AbstractNodeNetwork</code>.</p><p>The implicit Euler discretized dynamics matrix <code>A</code> is formed as follows:</p><p class="math-container">\[\bm{A}_{n,m} = \begin{cases}
\frac{C_m}{\Delta t} + \rho_m + \sum_{n&#39; \in N} H_{n,m}, \qquad n = m, \\
- H_{n,m}, \qquad n \neq m,
\end{cases}, \quad \text{where } n, m \in N\]</p><p>where <code>A_n,m</code> is the element of the dynamic matrix <code>A</code> on row <code>n</code> and column <code>m</code>, <code>C_m</code> is the thermal mass of node <code>m</code>, <code>Δt</code> is the length of the discretized time step, <code>ρ_m</code> is the self-discharge coefficient of node <code>m</code>, <code>N</code> is the set of nodes included in the lumped-capacitance thermal model, and <code>H_{m,n}</code> is the heat transfer coefficient between nodes <code>n</code> and <code>m</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L186-L205">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.form_and_invert_hvac_matrix" href="#ArchetypeBuildingModel.form_and_invert_hvac_matrix"><code>ArchetypeBuildingModel.form_and_invert_hvac_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">form_and_invert_hvac_matrix(
    dynamics_matrix::Matrix{Float64},
    temp_check::BitVector
)</code></pre><p>Forms and inverts the matrix for solving HVAC demand in different situations.</p><p>Essentially, this function performs the</p><p class="math-container">\[\left( \bm{A} - \sum_{m \in M}[\bm{A}_{m} + \bm{I}_{m}] \right)^{-1}\]</p><p>transformation of the dynamics matrix <code>A</code>, where the otherwise violated temperature variables <code>m ∈ M</code> are fixed and replaced with a variable for the required heating/cooling demand. See the <a href="#ArchetypeBuildingModel.solve_heating_demand"><code>solve_heating_demand</code></a> function for the overall formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L468-L484">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.initialize_temperatures" href="#ArchetypeBuildingModel.initialize_temperatures"><code>ArchetypeBuildingModel.initialize_temperatures</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize_temperatures(
    archetype::ArchetypeBuilding,
    indices::Vector{DateTime},
    dynamics_matrix::Matrix{Float64},
    inverted_dynamics_matrix::Matrix{Float64},
    external_load_vector::Vector{Vector{Float64}},
    thermal_mass_vector::Vector{Float64},
    free_dynamics::Bool,
    initial_temperatures::Union{Nothing,Dict{Object,Float64}},
)</code></pre><p>Initialize the temperature and temperature limit vectors for the heating/cooling demand calculations.</p><p>Initial temperatures are solved by repeatedly solving the first 24 hours until the end-result no longer changes. The initialization is abandoned if no stable initial temperatures are found within a thousand 24-hour solves. In this case, the minimum permitted temperatures are used as the initial temperatures for each node, unless otherwise specified via <code>initial_temperatures</code>. Internally, uses the <a href="#ArchetypeBuildingModel.solve_heating_demand_loop"><code>solve_heating_demand_loop</code></a> function.</p><p>See the <a href="#ArchetypeBuildingModel.solve_heating_demand"><code>solve_heating_demand</code></a> function for the overall logic and formulation of the heating demand calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L231-L256">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.initialize_rhs" href="#ArchetypeBuildingModel.initialize_rhs"><code>ArchetypeBuildingModel.initialize_rhs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize_rhs(
    archetype::ArchetypeBuilding,
    indices::Vector{Dates.DateTime},
    delta_t::Int64
)</code></pre><p>Initialize the right-hand side of the linear equation system, meaning the impact of the <code>external_load</code> and previous temperatures.</p><p>See the <a href="#ArchetypeBuildingModel.solve_heating_demand"><code>solve_heating_demand</code></a> function for the overall formulation. This function returns the right-hand side components separately</p><p class="math-container">\[\hat{\Phi} = \hat{\Phi&#39;} + \hat{\frac{C}{\Delta t} T_{t-\Delta t}},\]</p><p>where <code>Φ&#39;</code> is the component of external loads, and the rest is the component of the impact of previous temperatures. The components are useful for the <a href="#ArchetypeBuildingModel.solve_heating_demand_loop"><code>solve_heating_demand_loop</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L319-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_abstract_node" href="#ArchetypeBuildingModel.process_abstract_node"><code>ArchetypeBuildingModel.process_abstract_node</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_abstract_node(
    building_node_network::BuildingNodeNetwork,
    node::Object,
    weather::WeatherData
)</code></pre><p>Calculate the properties of an <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a> corresponding to the <code>node</code> in the <code>building_node_network</code>.</p><p>Combines all the individual parameters in <a href="#ArchetypeBuildingModel.BuildingNodeData"><code>BuildingNodeData</code></a>s in <a href="#ArchetypeBuildingModel.BuildingNodeNetwork"><code>BuildingNodeNetwork</code></a> into the bare minimum parameters required for modelling lumped-capacitance thermal nodes in our energy system modelling frameworks.</p><p>Essentially, this function performs the following steps:</p><ol><li>Sum all the thermal mass components together and convert into [Wh/K].</li><li>Sum all the self-discharge and ambient heat transfer components together.</li><li>Collect heat transfer coefficients between the interior air node and this one.</li><li>Update heat transfer coefficients based on user-defined coefficients.</li><li>Sum together the internal heat gains, solar gains, DHW demand, as well as the impact of ambient temperatures.</li><li>Return the components required for constructing an <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>.</li></ol><p><strong>NOTE!</strong> The ambient temperatures are accounted for via a combination of <code>self_discharge_coefficient_W_K</code> and <code>external_load</code>, instead of  <code>heat_transfer_coefficients_W_K</code> on any ambient temperature nodes. This is because not all large-scale energy system models support ambient temperatures as separate parameters, whereas self-discharge and external loads are almost always supported. The principle is illustrated by the equation below:</p><p class="math-container">\[\Phi_\text{ambient heat losses} = H_\text{ext}(T_\text{ambient} - T_\text{internal}) \\
= H_\text{ext} T_\text{ambient} - H_\text{ext} T_\text{internal} \\
= \Phi_\text{ambient} - \Phi_\text{self-discharge}\]</p><p><strong>NOTE!</strong> All heat transfer coefficients are assumed to be symmetrical! <strong>NOTE!</strong> All <a href="#ArchetypeBuildingModel.AbstractNode"><code>AbstractNode</code></a>s are given <code>1e-9 Wh/K</code> thermal mass to avoid singularities when solving the temperature dynamics and heat demand later on.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L848-L883">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_abstract_system" href="#ArchetypeBuildingModel.process_abstract_system"><code>ArchetypeBuildingModel.process_abstract_system</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_abstract_system(process::BuildingProcessData; mod::Module = @__MODULE__)</code></pre><p>Process a <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a> into an <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, combines the properties of a <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a> into the bare minimum parameters required to describe a &quot;process&quot; in our large-scale energy system modelling frameworks. Performs the following steps:</p><ol><li>COP mode indicated using COP sign, positive for heating and negative for cooling.</li><li>Scale COP to account for boundary between buildings and system link nodes. W -&gt; MW conversion and accounting for the total number of processes.</li><li>Factor COP mode into the <code>maximum_flows_W</code> dictionary.</li><li>Return the components for <a href="#ArchetypeBuildingModel.AbstractProcess"><code>AbstractProcess</code></a>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_system.jl#L217-L233">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_building_envelope" href="#ArchetypeBuildingModel.process_building_envelope"><code>ArchetypeBuildingModel.process_building_envelope</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_building_envelope(archetype::Object, data::ScopeData; mod::Module = @__MODULE__)</code></pre><p>Calculate the dimensions of the <code>archetype</code> building envelope based on the assumptions and aggregated building stock data.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, the archetype buildings are assumed to be rectangular in shape, with their external dimensions primarily governed by the <code>number_of_storeys</code>, <code>building_frame_depth_m</code>, and <code>room_height_m</code> parameters. The <code>average_gross_floor_area_m2_per_building</code> is divided into the desired number of floors, and the perimeter walls are calculated by assuming <code>building_frame_depth_m</code> as the length of two parallel walls, and determining the length of the two perpendicular walls based on the floor area. In case of non-integer <code>number_of_storeys</code>, only the topmost floor is assumed to deviate in shape from the rest, and the size of the partial floor is reduced by decreasing the length of the wall that isn&#39;t fixed to <code>building_frame_depth_m</code>.</p><p><strong>Note that for interior structures like separating floors and partition walls, the <code>surface_area_m2</code> only includes the surface area of one side of the structure!</strong> Accounting for coupling of both surfaces to the interior air is handled through the <code>external_U_value_to_ambient_air_W_m2K</code> and <code>internal_U_value_to_structure_W_m2K</code> parameters.</p><p>The building envelope calculations proceed as follows:</p><ol><li>Base floor dimensions using <a href="#ArchetypeBuildingModel.calculate_base_floor_dimensions"><code>calculate_base_floor_dimensions</code></a>.</li><li>Roof dimensions using <a href="#ArchetypeBuildingModel.calculate_roof_dimensions"><code>calculate_roof_dimensions</code></a>.</li><li>Separating floor dimensions using <a href="#ArchetypeBuildingModel.calculate_separating_floor_dimensions"><code>calculate_separating_floor_dimensions</code></a>.</li><li>Total vertical envelope area using <a href="#ArchetypeBuildingModel.calculate_vertical_envelope_surface_area"><code>calculate_vertical_envelope_surface_area</code></a>.</li><li>Window dimensions using <a href="#ArchetypeBuildingModel.calculate_window_dimensions"><code>calculate_window_dimensions</code></a>.</li><li>Exterior wall dimensions using <a href="#ArchetypeBuildingModel.calculate_exterior_wall_dimensions"><code>calculate_exterior_wall_dimensions</code></a>.</li><li>Partition wall dimensions using <a href="#ArchetypeBuildingModel.calculate_partition_wall_dimensions"><code>calculate_partition_wall_dimensions</code></a>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_envelope.jl#L8-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_building_loads" href="#ArchetypeBuildingModel.process_building_loads"><code>ArchetypeBuildingModel.process_building_loads</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_building_loads(
    archetype::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    weather::WeatherData;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculate the domestic hot water demand, internal and solar heat gains for the archetype building.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, performs the following steps:</p><ol><li>Finds the <code>building_loads</code> object corresponding to the <code>building_archetype</code>.</li><li>Calculates total domestic hot water (DHW) demand using <a href="#ArchetypeBuildingModel.calculate_total_dhw_demand"><code>calculate_total_dhw_demand</code></a>.</li><li>Calculates total internal heat loads using <a href="#ArchetypeBuildingModel.calculate_total_internal_heat_loads"><code>calculate_total_internal_heat_loads</code></a>.</li><li>Calculates total solar gains using <a href="#ArchetypeBuildingModel.calculate_total_solar_gains"><code>calculate_total_solar_gains</code></a>.</li><li>Returns the calculated DHW demand, internal gains, and solar gains.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_loads.jl#L9-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_building_node" href="#ArchetypeBuildingModel.process_building_node"><code>ArchetypeBuildingModel.process_building_node</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_building_node(
    node::Object,
    scope::ScopeData,
    envelope::EnvelopeData,
    loads::LoadsData;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculates the properties of a <code>node</code> using the provided <code>scope</code>, <code>envelope</code>, and <code>loads</code> data.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Aggregates the properties of the allocated structures according to their <code>structure_type_weight</code> parameters. The fenestration and ventilation properties are allocated according to <code>interior_air_and_furniture_weight</code>. Division of internal heat gains and solar heat gains between the interior air and the different structure types is based on the <code>interior_air_and_furniture_weight</code>, the relative surface areas of the different structure types and their <code>structure_type_weights</code>, as well as the <code>internal_heat_gain_convective_fraction</code> parameter for controlling the assumed convective vs radiative fractions of the internal gains. Solar gains are divided between the interior air and structures similar to internal heat gains, but use the <code>solar_heat_gain_convective_fraction</code> parameter for their convective vs radiative fraction instead.</p><p>Essentially, this function performs the following steps:</p><ol><li>Fetch user defined thermal mass, self-discharge, temperature set-point, and heat transfer coefficient parameters.</li><li>Calculate the thermal mass on the <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_interior_air_and_furniture_thermal_mass"><code>calculate_interior_air_and_furniture_thermal_mass</code></a> and <a href="#ArchetypeBuildingModel.calculate_structural_thermal_mass"><code>calculate_structural_thermal_mass</code></a>.</li><li>Calculate the total heat transfer coefficient between the structures on this <code>node</code> and the interior air using <a href="#ArchetypeBuildingModel.calculate_structural_interior_heat_transfer_coefficient"><code>calculate_structural_interior_heat_transfer_coefficient</code></a>.</li><li>Calculate the total heat transfer coefficient between the structures on this <code>node</code> and the ambient air using <a href="#ArchetypeBuildingModel.calculate_structural_exterior_heat_transfer_coefficient"><code>calculate_structural_exterior_heat_transfer_coefficient</code></a>.</li><li>Calculate the total heat transfer coefficient between the structures on this <code>node</code> and the ground using <a href="#ArchetypeBuildingModel.calculate_structural_ground_heat_transfer_coefficient"><code>calculate_structural_ground_heat_transfer_coefficient</code></a>.</li><li>Calculate the total heat transfer coefficient through windows for this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_window_heat_transfer_coefficient"><code>calculate_window_heat_transfer_coefficient</code></a>.</li><li>Calculate the total heat transfer coefficient of ventilation and infiltration on this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_ventilation_and_infiltration_heat_transfer_coefficient"><code>calculate_ventilation_and_infiltration_heat_transfer_coefficient</code></a>.</li><li>Calculate the total heat transfer coefficient of thermal bridges for this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_total_thermal_bridge_heat_transfer_coefficient"><code>calculate_total_thermal_bridge_heat_transfer_coefficient</code></a>.</li><li>Fetch domestic hot water demand from <code>loads</code> for this <code>node</code>.</li><li>Calculate the convective internal heat gains on this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_convective_internal_heat_gains"><code>calculate_convective_internal_heat_gains</code></a>.</li><li>Calculate the radiative internal heat gains on this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_radiative_internal_heat_gains"><code>calculate_radiative_internal_heat_gains</code></a>.</li><li>Calculate the convective solar heat gains on this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_convective_solar_gains"><code>calculate_convective_solar_gains</code></a>.</li><li>Calculate the radiative solar heat gains on this <code>node</code> using <a href="#ArchetypeBuildingModel.calculate_radiative_solar_gains"><code>calculate_radiative_solar_gains</code></a>.</li><li>Return all the pieces necessary for constructing the <a href="#ArchetypeBuildingModel.BuildingNodeData"><code>BuildingNodeData</code></a> for this <code>node</code>.</li></ol><p><strong>NOTE! Linear thermal bridges are assumed to bypass any potential structural lumped-capacitance nodes, and apply directly to the heat transfer coefficient between the interior air and the ambient air!</strong> <strong>NOTE! Currently, radiative internal and solar gains are lost through the windows in the building envelope.</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_node.jl#L50-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_building_stock_scope" href="#ArchetypeBuildingModel.process_building_stock_scope"><code>ArchetypeBuildingModel.process_building_stock_scope</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_building_stock_scope(scope::Object; mod::Module = @__MODULE__)</code></pre><p>Process the aggregated <code>building_stock_statistic</code> properties of a <code>scope</code>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Returns the gross-floor area weighted total <code>number_of_buildings</code> and <code>average_gross_floor_area_m2_per_building</code> defined by the <code>building_scope</code> and its associated relationships. Furthermore, returns the gross-floor area weights for the <code>building_type__building_period__location_id</code> useful for weighting the structural and fenestration/ventilation data.</p><p>Essentially, performs the following steps:</p><ol><li>Filter out irrelevant building stock statistics and check there are any left.</li><li>Calculate the gross-floor area weights using <a href="#ArchetypeBuildingModel.calculate_gross_floor_area_weights"><code>calculate_gross_floor_area_weights</code></a>.</li><li>Aggregate the gross-floor area weights using <a href="#ArchetypeBuildingModel.aggregate_gfa_weights"><code>aggregate_gfa_weights</code></a>.</li><li>Return the necessary pieces to construct a <a href="#ArchetypeBuildingModel.ScopeData"><code>ScopeData</code></a>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_scope.jl#L8-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_building_system" href="#ArchetypeBuildingModel.process_building_system"><code>ArchetypeBuildingModel.process_building_system</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_building_system(
    archetype::Object,
    process::Object,
    scope::ScopeData,
    weather::WeatherData;
    mod::Module = @__MODULE__,
)</code></pre><p>Calculates the properties required for creating a <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially performs the following steps:</p><ol><li>Fetch the <code>number_of_processes</code>, <code>system_link_nodes</code>, and <code>COP_mode</code> from the definitions.</li><li>Calculate the coefficient of performance using the <a href="#ArchetypeBuildingModel.calculate_cop"><code>calculate_cop</code></a> function.</li><li>Fetch the defined maximum power flows.</li><li>Return the components for <a href="#ArchetypeBuildingModel.BuildingProcessData"><code>BuildingProcessData</code></a>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_system.jl#L8-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_structure_scope" href="#ArchetypeBuildingModel.process_structure_scope"><code>ArchetypeBuildingModel.process_structure_scope</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_structure_scope(
    aggregated_gfa_weights::Dict{NTuple{3,Object},Float64};
    mod::Module = @__MODULE__,
)</code></pre><p>Aggregate <code>structure_statistics</code> using gross-floor area weights.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, this function calculates the aggregate properties of structures based on the aggregated gross floor area weights produced by the <a href="#ArchetypeBuildingModel.aggregate_gfa_weights"><code>aggregate_gfa_weights</code></a> function. Returns the gross-floor area weighted average structural properties as <a href="#ArchetypeBuildingModel.StructureData"><code>StructureData</code></a> for different <code>structure_type</code>s. These include the design U-values [W/m2K], effective thermal mass [J/m2K], linear thermal bridges [W/mK], and and U-values for heat transfer between the building interior and the structure, the structure and ambient air, the structure and ground, as well as the total U-value through the structure.</p><p class="math-container">\[p_\text{avg} = \sum_{\text{bt,bp,lid}} w_\text{bt,bp,lid} p_\text{bt,bp,lid}\]</p><p>where <code>p</code> is any of the above listed properties to be aggregated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_scope.jl#L315-L339">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_ventilation_and_fenestration_scope" href="#ArchetypeBuildingModel.process_ventilation_and_fenestration_scope"><code>ArchetypeBuildingModel.process_ventilation_and_fenestration_scope</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_ventilation_and_fenestration_scope(
    aggregated_gfa_weights::Dict{NTuple{3,Object},Float64};
    mod::Module = @__MODULE__,
)</code></pre><p>Aggregate <code>ventilation_and_fenestration_statistics</code> using gross-floor area weights.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, this function calculates the aggregate properties of ventilation and fenestration based on the aggregated gross-floor area weights produced by the <a href="#ArchetypeBuildingModel.aggregate_gfa_weights"><code>aggregate_gfa_weights</code></a> function. Returns the gross-floor area weighted average HRU-efficiency, infiltration rate [1/h], ventilation rate [1/h], window U-values [W/m2K], and window total normal solar energy transmittance.</p><p class="math-container">\[p_\text{avg} = \sum_{\text{bt,bp,lid}} w_\text{bt,bp,lid} p_\text{bt,bp,lid}\]</p><p>where <code>p</code> is any of the above listed properties to be aggregated. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_scope.jl#L272-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.process_weather" href="#ArchetypeBuildingModel.process_weather"><code>ArchetypeBuildingModel.process_weather</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process_weather(weather::Object; mod::Module = @__MODULE__)</code></pre><p>Process <code>weather</code> data for the <a href="#ArchetypeBuildingModel.WeatherData"><code>WeatherData</code></a> constructor.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Essentially, performs the following steps:</p><ol><li>Fetch the ambient temperature data for <code>weather</code>.</li><li>Calculate the effective ground temperature using <a href="#ArchetypeBuildingModel.calculate_effective_ground_temperature"><code>calculate_effective_ground_temperature</code></a>.</li><li>Fetch diffuse and direct solar irradiation data.</li><li>Return the components for the <a href="#ArchetypeBuildingModel.WeatherData"><code>WeatherData</code></a> constructor.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/process_weather.jl#L8-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.solve_consumption" href="#ArchetypeBuildingModel.solve_consumption"><code>ArchetypeBuildingModel.solve_consumption</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_consumption(
    archetype::ArchetypeBuilding,
    hvac_demand::Dict{Object,T} where {T&lt;:SpineDataType};
    mod::Module = @__MODULE__,
)</code></pre><p>Solve the consumption of <code>abstract_process</code> included in the <code>archetype</code>, based on the <code>hvac_demand</code>.</p><p>NOTE! The <code>mod</code> keyword changes from which Module data is accessed from, <code>@__MODULE__</code> by default.</p><p>Currently produces only extremely simple estimates, where each <code>abstract_process</code> is assumed to handle the demand on their output nodes in full, regardless of what the other <code>abstract_processes</code> are doing. Thus, the results cannot be used as is for systems with complimentary HVAC processess, and the merit-order assumptions are left up to the user.</p><p>Heating and cooling are handled separately, though.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_consumption.jl#L8-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.solve_heating_demand" href="#ArchetypeBuildingModel.solve_heating_demand"><code>ArchetypeBuildingModel.solve_heating_demand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_heating_demand(
    archetype::ArchetypeBuilding,
    free_dynamics::Bool,
    initial_temperatures::Union{Nothing,Dict{Object,Float64}},
)</code></pre><p>Solve the heating/cooling demand of the <code>archetype</code>.</p><p>Note that this function calculates the &quot;final energy demand&quot; of the archetype building, and not the energy consumption of it&#39;s HVAC systems. See the <a href="#ArchetypeBuildingModel.solve_consumption"><code>solve_consumption</code></a> function for that. Essentially, performs the following steps:</p><ol><li>Check external load data and <a href="#ArchetypeBuildingModel.determine_temporal_structure"><code>determine_temporal_structure</code></a>.</li><li><a href="#ArchetypeBuildingModel.form_and_invert_dynamics_matrix"><code>form_and_invert_dynamics_matrix</code></a> for the free temperature dynamics.</li><li>Initialize external load an thermal mass vectors using <a href="#ArchetypeBuildingModel.initialize_rhs"><code>initialize_rhs</code></a>.</li><li>Initialize temperature and temperature limit vectors using <a href="#ArchetypeBuildingModel.initialize_temperatures"><code>initialize_temperatures</code></a>.</li><li>Solve the heating demand using <a href="#ArchetypeBuildingModel.solve_heating_demand_loop"><code>solve_heating_demand_loop</code></a>.</li><li>Rearrange the solution into <code>Dict</code>s and return them.</li></ol><p>Uses an extremely simple rule-based control to solve the heating/cooling demand of the archetype building. The controller intervenes whenever node temperatures would deviate from permitted limits, and provides the required energy input to maintain the system at the limit.</p><p>The building dynamics are discretized using implicit <em>(backwards)</em> Euler, mainly for consistency with our existing energy system modelling tools like Backbone or SpineOpt. In principle, I believe the system could be solved analytically similar to my Master&#39;s Thesis, if better accuracy would be desired: <em>Energy Management in Households with Coupled Photovoltaics and Electric Vehicles, Topi Rasku, 2015, Aalto University School of Science</em>.</p><p>The idea of solving heating demand calculations can be as follows, starting from the energy balance equation for node <code>n</code></p><p class="math-container">\[C_n \frac{dT_n(t)}{dt} = - \rho_n T_n(t) + \sum_{m \in N} \left[ H_{n,m} \left( T_m(t) - T_n(t) \right) \right] + \Phi_n(t),\]</p><p>where <code>C_n</code> is the heat capacity of node <code>n</code>, <code>T_n(t)</code> is the time-dependent temperature of node <code>n</code> at time <code>t</code>, <code>ρ_n</code> is the self-discharge from node <code>n</code>, <code>N</code> is the set of temperature nodes in the lumped-capacitance model of the building, <code>H_n,m</code> is the heat transfer coefficient between nodes <code>n</code> and <code>m</code>, and <code>Φ_n(t)</code> is the time-dependent total external heat load on node <code>n</code>. Using the implicit Euler discretization, the above can be cast into</p><p class="math-container">\[\left( \frac{C_n}{\Delta t} + \rho_n + \sum_{m \in N} H_{n,m} \right) T_{n,t} - \sum_{m \in N} \left[ H_{n,m} T_{m,t} \right] = \Phi_{n,t} + \frac{C_n}{\Delta t} T_{n,t-\Delta t},\]</p><p>where <code>Δt</code> is the length of the discretized time step. Since we always know the temperatures on the previous time step <code>t-Δt</code>, the above can be expressed in matrix form and solved as</p><p class="math-container">\[\bm{A} \hat{T} = \hat{\Phi}, \\
\hat{T} = \bm{A}^{-1} \hat{\Phi},\]</p><p>where <code>A</code> is the so-called <em>dynamics matrix</em>,  <code>T</code> is the current temperature vector, and <code>Φ</code> is the right-hand side vector, containing the effect of external loads and previous temperatures.</p><p>The above is used to calculate the temperatures of the nodes on each subsequent time step. However, when any of the node temperatures would violate the defined minimum and maximum permitted temperatures, that temperature variable is instead fixed to the violated boundary, moved to the right-hand side, and replaced with a heating/cooling demand variable <code>ϕ_m</code> instead. This results in a slightly modified problem to be solved</p><p class="math-container">\[\hat{\phi} = \left( \bm{A} - \sum_{m \in M}[\bm{A}_{m} + \bm{I}_{m}] \right)^{-1} \left( \hat{\Phi} - \sum_{m \in M}[\hat{A}_{m} T&#39;_m] \right),\]</p><p>where <code>ϕ</code> is the modified temperature vector with the fixed temperature replaced with the heating/cooling demand variable, <code>m ∈ M</code> are the nodes that would violate their permitted bounds, and are therefore fixed at the boundary <code>T&#39;_m</code>, <code>A_m</code> represents a selection of column <code>m</code> from the matrix <code>A</code>, and <code>I_m</code> represents column <code>m</code> from an identity matrix. Please note that there are both matrix and vector selections of <code>A_m</code>, where the matrix selection preserves the dimensions with filling zeroes, while the vector selection is essentially only the selected column in vector form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L8-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.solve_heating_demand_loop" href="#ArchetypeBuildingModel.solve_heating_demand_loop"><code>ArchetypeBuildingModel.solve_heating_demand_loop</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_heating_demand_loop(
    indices::Vector{DateTime},
    dynamics_matrix::Matrix{Float64},
    inverted_dynamics_matrix::Matrix{Float64},
    temperatures::Vector{Vector{Float64}},
    min_temperatures::Vector{Float64},
    max_temperatures::Vector{Float64},
    external_load_vector::Vector{Vector{Float64}},
    thermal_mass_vector::Vector{Float64},
    free_dynamics::Bool,
    initial_temperatures::Vector{Float64}
)</code></pre><p>Solve the heating/cooling demand one timestep at a time over the given indices.</p><p>Essentially, performs the following steps:</p><ol><li>Initialize the temperature vector, HVAC demand vector, and a dictionary for the dynamic matrices for solving the problem.</li><li>Loop over the given <code>indices</code> and do the following:<ol><li>Solve new temperatures if HVAC not in use.</li><li>Check if new temperatures would violate temperature limits.</li><li>If necessary, solve the HVAC demand required to keep temperatures within set limits.</li></ol></li><li>Return the solved temperatures and HVAC demand for each node and index.</li></ol><p>See the <a href="#ArchetypeBuildingModel.solve_heating_demand"><code>solve_heating_demand</code></a> function for the overall formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/solve_demand.jl#L357-L382">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ArchetypeBuildingModel.timeseries_to_backbone_map" href="#ArchetypeBuildingModel.timeseries_to_backbone_map"><code>ArchetypeBuildingModel.timeseries_to_backbone_map</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">timeseries_to_backbone_map(ts::TimeSeries)</code></pre><p>Convert <code>TimeSeries</code> into Backbone input data <code>Map</code> corresponding to time-varying data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vttresearch/ArchetypeBuildingModel/blob/742f093ba9ca921ef78b01784b8f748c01b71a92/src/create_backbone_input.jl#L403-L407">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../archetype_definitions/">« Input data reference</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Monday 12 September 2022 13:44">Monday 12 September 2022</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
